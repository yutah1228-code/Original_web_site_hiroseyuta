;/*FB_PKG_DELIM*/

__d("CPXComposerConstants",[],(function(a,b,c,d,e,f){"use strict";a=120;b=68;c=90;d=160;e=10;var g=4;f.THUMBNAIL_WIDTH=a;f.THUMBNAIL_HEIGHT=b;f.REEL_THUMBNAIL_WIDTH=c;f.REEL_THUMBNAIL_HEIGHT=d;f.NUM_OF_THUMBNAILS=e;f.MAX_NUM_THUMBNAILS=g}),66);
__d("CanvasToBlobImpl",["BlobFactory"],(function(a,b,c,d,e,f){function a(a,c){a=atob(a.substr(a.indexOf(",")+1));var d=new Uint8Array(a.length);for(var e=0;e<a.length;e++)d[e]=a.charCodeAt(e);return b("BlobFactory").getBlob([d],{type:c})}e.exports={getBlob:a}}),null);
__d("VideoThumbnail_UNTYPED",["invariant","vulture"],(function(a,b,c,d,e,f,g){a=function(){"use strict";function a(a){this.$1=a}var c=a.prototype;c.getURL=function(){return this.$1};c.getData=function(){b("vulture")("a1B5XUEMmGR-xYeKTjqzsKYluSg="),g(0,4844)};a.addTextToCanvasContext=function(a,c,d,e,f,g,h,i,j){b("vulture")("qikNWy_gjGUk0GFVslGmB8bCVwk=");a.fillStyle=i;a.textAlign=j;a.font=g+"px "+h;i=j==="center"?e+f/2:e;h=1;j=c.split("\n");for(e of j){c="";j="";var k=e.split(" ");for(k of k){j+=k;var l=a.measureText(j).width,m=a.measureText(k).width;if(m>f){c.length>0&&(a.fillText(c,i,d+g*h),h++);m="";var n="";for(var o of k){n+=o;var p=a.measureText(n).width;p>f?(a.fillText(m,i,d+g*h),m=o,n=o,h++):m=n}c=m+" ";j=m+" "}else l>f?(a.fillText(c,i,d+g*h),c=k+" ",j=k+" ",h++):(j+=" ",c=j)}a.fillText(c,i,d+g*h);h++}return a};return a}();e.exports=a}),null);
__d("dataURLToBlob",["BlobFactory","CanvasToBlobImpl","CanvasToBlobResource","Promise","WebWorker"],(function(a,b,c,d,e,f,g){var h,i=a.URL||a.webkitURL||{};function e(a,e){if(!i.createObjectURL||!c("BlobFactory").isSupported)return(h||(h=b("Promise"))).reject("Browser doesn't support this feature");if(c("WebWorker").isSupported())return new(h||(h=b("Promise")))(function(b,d){var f=new(c("WebWorker"))(c("CanvasToBlobResource")).setMessageHandler(function(a){b(a),f.terminate()}).setErrorHandler(function(a){d(a.message),f.terminate()}).execute().postMessage({dataURL:a,fileType:e})});else return(h||(h=b("Promise"))).resolve(d("CanvasToBlobImpl").getBlob(a,e))}g["default"]=e}),98);
__d("canvasToBlob",["Promise","dataURLToBlob","promiseDone"],(function(a,b,c,d,e,f,g){var h;function a(a,d,e){return new(h||(h=b("Promise")))(function(b,f){if(a.toBlob)a.toBlob(b,d,e);else{var g=a.toDataURL(d,e);c("promiseDone")(c("dataURLToBlob")(g,d).then(function(a){b(a)},f))}})}g["default"]=a}),98);
__d("CanvasVideoThumbnail",["EventListener","Promise","VideoThumbnail_UNTYPED","canvasToBlob","promiseDone"],(function(a,b,c,d,e,f,g){var h;a=function(a){function d(b,c,d,e,f,g,h){var i;e===void 0&&(e=null);f===void 0&&(f=null);g===void 0&&(g=0);h===void 0&&(h=0);i=a.call(this,null)||this;i.$CanvasVideoThumbnail$p_1=b;i.$CanvasVideoThumbnail$p_2=c;i.$CanvasVideoThumbnail$p_3=d;i.$CanvasVideoThumbnail$p_4=e;i.$CanvasVideoThumbnail$p_5=f;i.$CanvasVideoThumbnail$p_6=g;i.$CanvasVideoThumbnail$p_7=h;i.$CanvasVideoThumbnail$p_8=i.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg");return i}babelHelpers.inheritsLoose(d,a);var e=d.prototype;e.getCanvas=function(){return this.$CanvasVideoThumbnail$p_1};e.getTime=function(){return this.$CanvasVideoThumbnail$p_3?this.$CanvasVideoThumbnail$p_3:0};e.getURL=function(){this.$CanvasVideoThumbnail$p_8||(this.$CanvasVideoThumbnail$p_8=this.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg"));return this.$CanvasVideoThumbnail$p_8};e.getData=function(){var a=this,d=document.createElement("canvas"),e=d.getContext("2d"),f=this.$CanvasVideoThumbnail$p_2;return new(h||(h=b("Promise")))(function(b,g){var h=c("EventListener").listen(f,"seeked",function(){h.remove(),a.$CanvasVideoThumbnail$p_9(d,e),c("promiseDone")(c("canvasToBlob")(d,"image/jpeg").then(b,g))});f.currentTime=a.$CanvasVideoThumbnail$p_3})};e.getDataWithText=function(a,d,e,f,g,i,j,k){var l=this,m=document.createElement("canvas"),n=m.getContext("2d"),o=this.$CanvasVideoThumbnail$p_2;return new(h||(h=b("Promise")))(function(b,h){var p=c("EventListener").listen(o,"seeked",function(){p.remove(),n.fillStyle=j,n.textAlign=k,l.$CanvasVideoThumbnail$p_9(m,n),n=c("VideoThumbnail_UNTYPED").addTextToCanvasContext(n,a,d,e,f,g,i,j,k),c("promiseDone")(c("canvasToBlob")(m,"image/jpeg").then(b,h))});o.currentTime=l.$CanvasVideoThumbnail$p_3})};e.$CanvasVideoThumbnail$p_9=function(a,b){var c=this.$CanvasVideoThumbnail$p_2;this.$CanvasVideoThumbnail$p_4||this.$CanvasVideoThumbnail$p_5?(a.width=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:c.videoWidth,a.height=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:c.videoHeight,this.$CanvasVideoThumbnail$p_10(a,b)):(a.width=c.videoWidth,a.height=c.videoHeight,b.drawImage(c,0,0,a.width,a.height))};e.$CanvasVideoThumbnail$p_10=function(a,b){var c=this.$CanvasVideoThumbnail$p_2,d=this.$CanvasVideoThumbnail$p_6,e=this.$CanvasVideoThumbnail$p_7,f=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:a.width,g=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:a.height;b.drawImage(c,d,e,f,g,0,0,a.width,a.height)};return d}(c("VideoThumbnail_UNTYPED"));g["default"]=a}),98);
__d("HTMLMediaElementReadyStates",[],(function(a,b,c,d,e,f){a={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4};b=a;f["default"]=b}),66);
__d("IGDComposerEmojiPicker.react",["IGDSBox.react","IGDSPopover.react","JSResourceForInteraction","WebUXLoggingSurfaceContextProvider","lazyLoadComponent","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=c("lazyLoadComponent")(c("JSResourceForInteraction")("IGDSEmojiTray.react").__setRef("IGDComposerEmojiPicker.react"));function a(a){var b=d("react-compiler-runtime").c(10),e=a.closeAfterSelect,f=a.onClose,g=a.onSelect,h=a.showPopoverArrow;a=a.threadKey;var k;b[0]!==e||b[1]!==f||b[2]!==g?(k=function(a,b){g(a),(e===!0||(b==null?void 0:b.type)==="keydown")&&f()},b[0]=e,b[1]=f,b[2]=g,b[3]=k):k=b[3];var l;b[4]!==k||b[5]!==a?(l=i.jsx(c("IGDSBox.react"),{width:340,children:i.jsx(d("WebUXLoggingSurfaceContextProvider").WebUXSurfaceLoggingContext.Provider,{value:"thread_chat_emoji_picker_sheet",children:i.jsx(j,{onClick:k,threadKey:a,width:"auto"})})}),b[4]=k,b[5]=a,b[6]=l):l=b[6];k=l;b[7]!==k||b[8]!==h?(a=i.jsx(c("IGDSPopover.react"),{align:"end",popoverContent:k,popoverName:"emojiTray",position:"above",withArrow:h}),b[7]=k,b[8]=h,b[9]=a):a=b[9];return a}g["default"]=a}),98);
__d("useIGDBroadcastChannelImpressionLoggerWithCheck",["MWCMThreadTypes.react","promiseDone","react","react-compiler-runtime","useIGDBroadcastChannelLogger","useSinglePartialViewImpression"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e){var f=d("react-compiler-runtime").c(6),g=c("useIGDBroadcastChannelLogger")(a);f[0]!==g||f[1]!==e||f[2]!==b?(a=function(){b!=null&&d("MWCMThreadTypes.react").isIGBroadcastChannelThread(b)&&c("promiseDone")(g(e))},f[0]=g,f[1]=e,f[2]=b,f[3]=a):a=f[3];a=a;var h;f[4]!==a?(h={onImpressionStart:a},f[4]=a,f[5]=h):h=f[5];return c("useSinglePartialViewImpression")(h)}g["default"]=a}),98);
__d("useIGDTriggerEditAction.react",["MAWEditMessageContext.react","MWPReplyContext.react","MessengerWebUXLogger","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useContext;function a(a,b,e){var f=d("react-compiler-runtime").c(10),g=c("MessengerWebUXLogger").useInteractionLogger(),h=i(d("MAWEditMessageContext.react").Context),j=h.setEditMessageData;h=i(d("MWPReplyContext.react").MWPReplyContext);var k=h.clearReply,l=h.reply;f[0]!==k||f[1]!==g||f[2]!==a.messageId||f[3]!==a.threadKey||f[4]!==a.timestampMs||f[5]!==e||f[6]!==l||f[7]!==j||f[8]!==b?(h=function(){l!=null&&k(a.threadKey,!0),j({messageId:a.messageId,threadKey:a.threadKey,threadType:b,timestampMs:a.timestampMs}),g==null||g({eventName:"edit_message_tap"}),e==null||e()},f[0]=k,f[1]=g,f[2]=a.messageId,f[3]=a.threadKey,f[4]=a.timestampMs,f[5]=e,f[6]=l,f[7]=j,f[8]=b,f[9]=h):h=f[9];return h}g["default"]=a}),98);
__d("useMWIsContactRestricted",["LSContactBitOffset"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a!=null&&d("LSContactBitOffset").has(66,a);return a}g["default"]=a}),98);
__d("useMWPCanUserEditMessage",["I64","LSAuthorityLevel","LSContactBitOffset","LSContactTypeExact","LSHotEmojiSize","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWThreadCutover","MWMessageDeliveryStatus","MWPActor.react","ReQL","ReQLSuspense","URLMatcher","getIsMessageTimeBelowEditThreshold","gkx","isDeliveryStatusErrorState","isMWBumpMessage","isStringNullOrEmpty","mwCMIsAnyCMThread","mwCMIsCMSubthread","useMWGetOtherUserContact","useMWIsContactRestricted","useReStore","useServerTime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=5;function a(a,b,e){var g,m,n,o=d("MWPActor.react").useActor(),p=(j||(j=c("useReStore")))(),q=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(p.tables.attachments).getKeyRange(a.threadKey,a.messageId)},[p,a.messageId,a.threadKey],f.id+":68"),r=c("useMWGetOtherUserContact")(a.threadKey,b.threadType,["contactTypeExact"].concat(d("LSContactBitOffset").contactCapabilityFields)),s=r!=null&&(h||(h=d("I64"))).equal(r.contactTypeExact,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").MESSENGER_KID));r=c("useMWIsContactRestricted")(r);e=d("MAWThreadCutover").useIsCutoverOpenThread(e);var t=c("useServerTime")();if(c("isDeliveryStatusErrorState")(d("MWMessageDeliveryStatus").getFromSendStatus(a.sendStatusV2)))return!1;if(b==null)return!1;g=(h||(h=d("I64"))).to_int32((g=a.editCount)!=null?g:(h||(h=d("I64"))).zero)<k;t=d("getIsMessageTimeBelowEditThreshold").getIsMessageTimeBelowEditThreshold(h.of_float(t.getTime()),a.timestampMs);o=h.equal(a.senderId,o);m=(m=a.isForwarded)!=null?m:!1;var u=a.text!=null&&a.text!=="",v=a.text!=null&&c("URLMatcher").match(a.text)!=null;n=h.equal((n=a.hotEmojiSize)!=null?n:(h||(h=d("I64"))).zero,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").NONE));q=((q=q==null?void 0:q.hasXma)!=null?q:!1)||!c("isStringNullOrEmpty")(a.mentionIds);var w=a.isUnsent===!1&&(h||(h=d("I64"))).equal(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)),x=c("isMWBumpMessage")(a.replyType);return g&&t&&o&&u&&!v&&n&&!m&&!e&&!q&&w&&!r&&!x&&!s&&l(b)}function l(a){var b=a.threadType;if(d("LSMessagingThreadTypeUtil").isWorkThread(a.threadSubtype))return!1;if(d("LSMessagingThreadTypeUtil").isArmadilloSecure(b))return!0;if(d("LSMessagingThreadTypeUtil").isJoinedDiscoverablePublicBroadcastChannel(b))return!0;if(c("mwCMIsAnyCMThread")(b)||c("mwCMIsCMSubthread")(b))return d("LSThreadBitOffset").has(194,a)&&c("gkx")("7675");return d("LSMessagingThreadTypeUtil").isOpenFnFThread(a)?!0:!1}g["default"]=a}),98);
__d("useIGDEditMessageMenuItem.react",["fbt","I64","IGDMessageContextMenuItem.react","IGDSEditPanoOutline24Icon.react","MWPActor.react","react","react-compiler-runtime","useIGDTriggerEditAction.react","useMWPCanUserEditMessage"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a,b,e){var f=d("react-compiler-runtime").c(4),g=d("MWPActor.react").useActor(),i=a.senderId;i=(j||(j=d("I64"))).equal(i,g);var l=c("useIGDTriggerEditAction.react")(a,e.threadType,b);g=c("useMWPCanUserEditMessage")(a,e);if(!i||!g)return null;f[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=h._(/*BTDS*/"\u7de8\u96c6"),f[0]=b):b=f[0];a=b;f[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=k.jsx(c("IGDSEditPanoOutline24Icon.react"),{alt:a,size:18}),f[1]=e):e=f[1];f[2]!==l?(i=k.jsx(c("IGDMessageContextMenuItem.react"),{icon:e,label:a,onClick:function(){l()},testid:void 0}),f[2]=l,f[3]=i):i=f[3];return i}g["default"]=a}),226);
__d("IGDSCopyPanoOutline24Icon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"m20.12 4.707-2.826-2.828A3.026 3.026 0 0 0 15.17 1h-5.167A3.007 3.007 0 0 0 7 4.004V5h-.996A3.007 3.007 0 0 0 3 8.004v11.992A3.007 3.007 0 0 0 6.004 23h7.992A3.007 3.007 0 0 0 17 19.996V19h.996A3.007 3.007 0 0 0 21 15.996V6.83a2.98 2.98 0 0 0-.88-2.123ZM18.586 6 16 6.001V3.414L18.586 6ZM15 19.996C15 20.55 14.55 21 13.996 21H6.004C5.45 21 5 20.55 5 19.996V8.004C5 7.45 5.45 7 6.004 7H7v8.996A3.007 3.007 0 0 0 10.004 19H15v.996ZM17.996 17h-7.992C9.45 17 9 16.55 9 15.996V4.004C9 3.45 9.45 3 10.004 3H14v3.001A2 2 0 0 0 15.999 8H19v7.996C19 16.55 18.55 17 17.996 17Z"}),b[0]=e):e=b[0];b[1]!==a?(e=i.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:e})),b[1]=a,b[2]=e):e=b[2];return e}b=i.memo(a);g["default"]=b}),98);
__d("useIGDMessageCopyMenuItem.react",["fbt","Clipboard","I64","IGDMessageContextMenuItem.react","IGDSCircleCheckOutlineIcon.react","IGDSCopyPanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","LSIntEnum","LSMessageReplySourceTypeV2","MWPActor.react","MessengerWebUXLogger","getInstamadilloLoggingExtraData","promiseDone","react","react-compiler-runtime","requireDeferred","useIGDSToaster","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||d("react"),n=c("requireDeferred")("MWLogMessageAction").__setRef("useIGDMessageCopyMenuItem.react");function a(a,b,e){var f=d("react-compiler-runtime").c(27),g=(i||(i=c("useReStore")))(),l=d("MWPActor.react").useActor(),o=c("MessengerWebUXLogger").useInteractionLogger(),p=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),q=a.displayedContentTypes,r=a.replySourceTypeV2!=null&&(j||(j=d("LSIntEnum"))).toNumber(a.replySourceTypeV2)===c("LSMessageReplySourceTypeV2").FORWARD;q=(k||(k=d("I64"))).equal(q,(j||(j=d("LSIntEnum"))).ofNumber(1))||(k||(k=d("I64"))).equal(q,(j||(j=d("LSIntEnum"))).ofNumber(1033));q=q||r&&!!a.text;var s=c("useIGDSToaster")();f[0]!==l||f[1]!==g||f[2]!==p||f[3]!==o||f[4]!==a.messageId||f[5]!==a.senderId||f[6]!==a.text||f[7]!==a.threadKey||f[8]!==b||f[9]!==e||f[10]!==s?(r=function(){var f;o==null||o({eventName:"message_copy",extraData:c("getInstamadilloLoggingExtraData")(e),flowInstanceId:p});d("Clipboard").copy((f=a.text)!=null?f:"");b();s.add({icon:m.jsx(c("IGDSCircleCheckOutlineIcon.react"),{alt:h._(/*BTDS*/"\u30c1\u30a7\u30c3\u30af\u30de\u30fc\u30af\u30a2\u30a4\u30b3\u30f3")}),message:h._(/*BTDS*/"\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3057\u305f")});n.onReady(function(b){return c("promiseDone")(b.log(g,a.messageId,a.threadKey,"message_dot_menu","copy",void 0,void 0,void 0,a.senderId,void 0,l))})},f[0]=l,f[1]=g,f[2]=p,f[3]=o,f[4]=a.messageId,f[5]=a.senderId,f[6]=a.text,f[7]=a.threadKey,f[8]=b,f[9]=e,f[10]=s,f[11]=r):r=f[11];var t;f[12]!==l||f[13]!==g||f[14]!==p||f[15]!==o||f[16]!==a.messageId||f[17]!==a.senderId||f[18]!==a.text||f[19]!==a.threadKey||f[20]!==b||f[21]!==e?(t=[l,g,p,o,a.messageId,a.senderId,a.text,a.threadKey,b,e],f[12]=l,f[13]=g,f[14]=p,f[15]=o,f[16]=a.messageId,f[17]=a.senderId,f[18]=a.text,f[19]=a.threadKey,f[20]=b,f[21]=e,f[22]=t):t=f[22];r=d("Int64Hooks").useCallbackInt64(r,t);if(!q)return null;f[23]===Symbol["for"]("react.memo_cache_sentinel")?(t=h._(/*BTDS*/"\u30b3\u30d4\u30fc"),f[23]=t):t=f[23];q=t;f[24]===Symbol["for"]("react.memo_cache_sentinel")?(t=m.jsx(c("IGDSCopyPanoOutline24Icon.react"),{alt:q,size:18}),f[24]=t):t=f[24];f[25]!==r?(t=m.jsx(c("IGDMessageContextMenuItem.react"),{icon:t,label:q,onClick:r}),f[25]=r,f[26]=t):t=f[26];return t}g["default"]=a}),226);
__d("MAWDocumentPreProcess",["Promise","WABlobToArrayBuffer","WATagsLogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS(["MAWDocumentPreProcess"]);function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){k.DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["start document preprocess"])));return(j||(j=b("Promise"))).resolve({file:a,filename:a.name,plaintext:yield d("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"document"})});return l.apply(this,arguments)}function e(c){k.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start optimistic document preprocess"])));var d=a.URL.createObjectURL(c);return(j||(j=b("Promise"))).resolve({file:c,filename:c.name,type:"document",url:d})}g.documentPreprocess=c;g.optimisticDocumentPreprocess=e}),98);
__d("MAWFetchXMADataUtils",["FBLogger","LSXmaContentType","MAWFetchXMABlob","MAWGetImageSpec","MAWParseXMAFBConfig","Promise","WAArmadilloXMA.pb","asyncToGeneratorRuntime","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i={failed_to_fetch_blob_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent",failed_to_fetch_json_for_xma_share:"Failed execute MAWShareAttachment_LinkPreviewQuery for MAWShareAttachent",failed_to_parse_json_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent"};function a(a){var b=Object.entries(c("LSXmaContentType")).find(function(b){var c=b[0];b=b[1];return a===b&&d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[c]!=null});b=b!=null?d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[b[0]]:void 0;if(b===void 0)return void 0;if(!d("MAWParseXMAFBConfig").isFBSupportedTargetType({fbTargetType:b,silentExposure:!0})){c("FBLogger")("messenger_web_sharing").mustfix("Unsupported XMA Target Type in sending path: "+b);return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE}return b}function e(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=a.favicon_blob,f=a.header_image_blob,g=a.overlayIconGlyph;a=a.preview_blob;a=a==null?void 0:new File([a],"preview",{type:a.type});e=e==null?void 0:new File([e],"favicon",{type:e.type});f=f==null?void 0:new File([f],"header",{type:f.type});d("sendToSentQPLLogger").markSendToSentPoint(c,"preview_favicon_spec_start");g=g===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE?(h||(h=b("Promise"))).resolve({height:2,width:2}):a!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(a):(h||(h=b("Promise"))).resolve();var i=e!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(e):(h||(h=b("Promise"))).resolve(),j=f!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(f):(h||(h=b("Promise"))).resolve();g=(yield (h||(h=b("Promise"))).all([g,i,j]));i=g[0];j=g[1];g=g[2];d("sendToSentQPLLogger").markSendToSentPoint(c,"preview_favicon_spec_ready");c=a==null||i==null?void 0:{file:a,height:i.height,width:i.width};a=e==null||j==null?void 0:{file:e,height:j.height,width:j.width};i=f==null||g==null?void 0:{file:f,height:g.height,width:g.width};return{faviconFileArgs:a,headerImageFileArgs:i,previewFileArgs:c}});return j.apply(this,arguments)}function f(a,b,c,d,e,f){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j,k){a=(yield (h||(h=b("Promise"))).all([[(a==null?void 0:a.startsWith("ls"))===!0?null:a,"favicon"],[e,"image"],[f,"preview"],[g,"header_image"]].map(function(a){return d("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFetchXMAData_"+a[1],url:a[0],xmaContentType:k}).then(function(a){return a!=null?a:void 0})}))["catch"](function(a){j.forEach(function(a){d("sendToSentQPLLogger").markSendToSentFail(a,"failed_to_fetch_blob_for_xma_share")});c("FBLogger")("messenger_web_sharing").catching(a).mustfix(i.failed_to_fetch_blob_for_xma_share);return[void 0,void 0,void 0,void 0]}));e=a[0];f=a[1];g=a[2];a=a[3];return[e,f,g,a]});return k.apply(this,arguments)}g.XMA_DATA_ERRORS=i;g.convertXmaContentTypeToMessageType=a;g.makeXMAFileArgs=e;g.getPreviewBlobs=f}),98);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9840669832713841"}),null);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql",["MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"url"}],c=[{alias:null,args:[{fields:[{kind:"Variable",name:"url",variableName:"url"}],kind:"ObjectValue",name:"params"}],concreteType:"XFBXMAPreviewData",kind:"LinkedField",name:"xma_preview_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_receiver_fetch_supported",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_public",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtitle_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"xma_content_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favicon_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preview_url",storageKey:null},{alias:null,args:null,concreteType:"XFBXMAPreviewDataCtaDataConnection",kind:"LinkedField",name:"cta_data",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBXMACtaData",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_action_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_native_url",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:c},params:{id:b("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"),metadata:{},name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("MAWUnshimUrl",["CometLinkShimUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return void 0;var b=d("CometLinkShimUtils").getLinkShimInfo(a,void 0,void 0,void 0,void 0,!0);return!b.shimmed?a:b.unshimmedHref}g.unshimUrl=a}),98);
__d("MAWFetchXMAData",["fbt","CometRelay","ConstUriUtils","FBLogger","LSXmaContentType","MAWFetchXMADataUtils","MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql","MAWUnshimUrl","MSGDataclassTypes.flow","Promise","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getJSEnumSafe","isFacebookURI","isStringNullOrEmpty","justknobx","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function k(a,b){b.forEach(function(a){d("sendToSentQPLLogger").addSendToSentAnnotations(a,{string:{xma_data_result:"private"}})});return{defaultCTA:{actionUrl:d("MAWUnshimUrl").unshimUrl(a),buttonType:(b=d("WAArmadilloXMA.pb")).EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:d("MAWUnshimUrl").unshimUrl(a),title:h._(/*BTDS*/"_j[\"\\u975e\\u516c\\u958b\\u6295\\u7a3f\",\"599d20d959e0009397c73fb9edb426dd\",1]").toString()},linkType:"internal",overlayIconGlyph:b.EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE,preview_blob:void 0,title_text:h._(/*BTDS*/"Facebook").toString(),transportLayerForLogging:"sender_copy",xma_message_type:b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE,xmaTargetTypeForLogging:b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE}}function l(a,c){return d("CometRelay").fetchQuery(a,i!==void 0?i:i=b("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql"),{url:c}).toPromise()}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield l(a,b)["catch"](function(a){e.forEach(function(b){d("sendToSentQPLLogger").markSendToSentFail(b,"failed_to_fetch_json_for_xma_share",a)}),c("FBLogger")("messenger_web_sharing").catching(a).mustfix(d("MAWFetchXMADataUtils").XMA_DATA_ERRORS.failed_to_fetch_json_for_xma_share)}));e.forEach(function(a){d("sendToSentQPLLogger").markSendToSentPoint(a,"fetch_json_for_xma_share_end")});a=a==null?void 0:a.xma_preview_data;if(a==null){e.forEach(function(a){d("sendToSentQPLLogger").addSendToSentAnnotations(a,{string:{xma_data_result:"empty"}})});return k(b,e)}if(a.is_public!==!0)return k(b,e);e.forEach(function(a){d("sendToSentQPLLogger").addSendToSentAnnotations(a,{string:{xma_data_result:"public"}})});b={defaultCTA:{actionUrl:d("MAWUnshimUrl").unshimUrl(b),buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:d("MAWUnshimUrl").unshimUrl(b),title:(b=a.default_cta_title)!=null?b:void 0},linkType:"internal",title_text:(b=(b=a.title_text)!=null?b:a.header_title)!=null?b:void 0};var f=c("getJSEnumSafe")(c("LSXmaContentType"),a.xma_content_type),g=d("MAWFetchXMADataUtils").convertXmaContentTypeToMessageType(f),h=a.post_id,i=a.is_receiver_fetch_supported===!0;if(i&&h!=null){i={__typename:"XMSGMsgrXmaContentRefDataclass",action_type:d("MSGDataclassTypes.flow").XmsgMsgrXmaActionType.Share,content_type:d("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchContentType.Statusupdate,fetch_params:{__typename:"XMSGMsgrReceiverFetchXmaStatusUpdateFetchParams",post_id:h},xma_content_type:c("getJSEnumSafe")(c("LSXmaContentType"),a.xma_content_type),xma_layout_type:d("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchXmaLayoutType.Single};return babelHelpers["extends"]({},b,{contentRef:JSON.stringify(i),transportLayerForLogging:"receiver_fetch",xma_message_type:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH,xmaTargetTypeForLogging:g})}h=(yield d("MAWFetchXMADataUtils").getPreviewBlobs(a.favicon_url,null,a.preview_url,a.header_image_url,e,f));i=h[0];h[1];f=h[2];h=h[3];return babelHelpers["extends"]({},b,{ctas:(b=a.cta_data)==null||(b=b.nodes)==null?void 0:b.map(function(a){var b=d("MAWUnshimUrl").unshimUrl(c("isStringNullOrEmpty")(a.cta_action_url)?void 0:a.cta_action_url),e=d("MAWUnshimUrl").unshimUrl(c("isStringNullOrEmpty")(a.cta_native_url)?void 0:a.cta_native_url);return{actionUrl:b,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,ctaType:"xma_web_url",nativeUrl:e,title:(b=a.cta_title)!=null?b:void 0}}),favicon_blob:i!=null?i:void 0,header_image_blob:h!=null?h:void 0,header_title:c("isStringNullOrEmpty")(a.title_text)?void 0:(b=a.header_title)!=null?b:void 0,preview_blob:f!=null?f:void 0,subtitle_text:(i=a.subtitle_text)!=null?i:void 0,transportLayerForLogging:"sender_copy",xma_message_type:g,xmaTargetTypeForLogging:g})});return n.apply(this,arguments)}function a(a,e,f){var g,h=d("ConstUriUtils").getUri(e);h=h==null||(g=h.setSubDomain("www"))==null?void 0:g.toString();if(h==null)return(j||(j=b("Promise"))).resolve({linkType:"unknown",transportLayerForLogging:"sender_copy",xmaTargetTypeForLogging:null});e=d("MAWUnshimUrl").unshimUrl(e);if(e!=null){e=d("ConstUriUtils").getUri(e);if(e!=null&&!c("isFacebookURI")(e)&&c("justknobx")._("5006"))return(j||(j=b("Promise"))).resolve({linkType:"external",transportLayerForLogging:"sender_copy",xmaTargetTypeForLogging:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE})}f.forEach(function(a){d("sendToSentQPLLogger").markSendToSentPoint(a,"fetch_json_for_xma_share_start")});return m(a,h,f)}g.fetchXMAData=a}),226);
__d("MAWThreadMappingUtils",["FBLogger","LSMessagingThreadTypeUtil","MAWJids","MAWMiActOnActThreadReadyInstrumentation","Promise","ReQL","ReQLSubscribe","asyncToGeneratorRuntime","err","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=3e4;function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(a==null){c("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used.");return null}return d("LSMessagingThreadTypeUtil").isGroup(a.threadType)});return k.apply(this,arguments)}function l(a,e){return(h||(h=b("Promise"))).all([j(a,e),d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table).getKeyRange(e))]).then(function(a){var b=a[0];a=a[1];if(a==null||b==null){c("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used.");return null}return d("MAWJids").convertIntJidToChatJid(a.jid,b)})}function m(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table).getKeyRange(b)).then(function(a){if(a==null){c("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used.");return null}return a.jid})}function a(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g,k=null,m=(g=d("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(f);g.startQPL(m,f,e,"getChatJidOnceInThreadMappingTable");g.addPointQPL(m,"get_existing_int_jid_from_mapping_table_start");f=(yield l(a.tables,e));g.addPointQPL(m,"get_existing_int_jid_from_mapping_table_end");if(f!=null){d("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(m);return(h||(h=b("Promise"))).resolve(f)}var n=(yield j(a.tables,e));if(n==null){d("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(m,"thread_not_ready_to_be_used");throw c("FBLogger")("messenger_web").mustfixThrow("Thread is not ready to be used.")}d("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(m,"subscribe_to_mapping_table_start");return new(h||(h=b("Promise")))(function(b,f){var g=d("ReQL").fromTableDescending(a.tables.mi_act_mapping_table).getKeyRange(e),h=d("ReQLSubscribe").subscribeToFirst(g,function(a){a!=null&&(k!=null&&window.clearTimeout(k),h(),d("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(m,"subscribe_to_mapping_table_end"),d("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(m),b(d("MAWJids").convertIntJidToChatJid(a.jid,n)))});k=c("setTimeout")(function(){h(),d("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(m,"subscribe_to_mapping_table_timeout"),f(c("err")("Timeout waiting for int jid to be populated in mapping table."))},i)})});return n.apply(this,arguments)}function e(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g,j=null,k=(g=d("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(f);g.startQPL(k,f,e,"getIntJidOnceInThreadMappingTable");g.addPointQPL(k,"get_existing_int_jid_from_mapping_table_start");f=(yield m(a.tables,e));g.addPointQPL(k,"get_existing_int_jid_from_mapping_table_end");if(f!=null){d("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(k);return(h||(h=b("Promise"))).resolve(f)}d("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(k,"subscribe_to_mapping_table_start");return new(h||(h=b("Promise")))(function(b,f){var g=d("ReQL").fromTableDescending(a.tables.mi_act_mapping_table).getKeyRange(e),h=d("ReQLSubscribe").subscribeToFirst(g,function(a){a!=null&&(j!=null&&window.clearTimeout(j),h(),d("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(k,"subscribe_to_mapping_table_end"),d("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(k),b(a.jid))});j=c("setTimeout")(function(){h(),d("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(k,"subscribe_to_mapping_table_timeout"),f(c("err")("Timeout waiting for int jid to be populated in mapping table."))},i)})});return o.apply(this,arguments)}g.isThreadGroup=j;g.getChatJidFromMappingTable=l;g.getIntJidFromMappingTable=m;g.getChatJidOnceInThreadMappingTable=a;g.getIntJidOnceInThreadMappingTable=e}),98);
__d("MAWGetProtocolMsgIdByMsgIdInUI",["I64","LSDatabaseSingleton","MAWBridgeSendAndReceive","MAWMpsGating","MAWThreadMappingUtils","WAJids","WAStanzaUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WAJids").createJidUtils({platform:"msgr"});function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield (h||(h=d("LSDatabaseSingleton"))).getLSDatabaseSingletonPromiseOrValue());return c.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield b.messages.index("messageId").get(a));if(c==null)return null;b=(yield d("MAWThreadMappingUtils").getChatJidFromMappingTable(b,c.threadKey));if(b!=null)return{author:j.toUserJid((i||(i=d("I64"))).to_float(c.senderId).toString()),chat:b,externalId:d("WAStanzaUtils").toStanzaId(c.offlineThreadingId)}});return function(a){return c.apply(this,arguments)}}(),"readonly",void 0,void 0,f.id+":32")});return l.apply(this,arguments)}a=function(a){return d("MAWMpsGating").isFullMpsEnabled()?k(a):m(a)};var m=function(a){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:a})};g.getProtocolMsgIdByMsgIdUI=a}),98);
__d("MAWSendFileMsgTypes",["WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(a){return d("WAStanzaUtils").toStanzaId(a)}g.toOfflineAttachmentIDFromStanzaId=a;g.toOfflineAttachmentIDFromString=b}),98);
__d("MAWSecureAttachmentGroupingUtils",["I64","LSIntEnum","MAWSendFileMsgTypes","MessagingAttachmentType","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){a=a.reduce(function(a,b){(h||(h=d("I64"))).equal(b.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))?a.mediaStagingsImage.push(b):a.mediaStagingsOther.push(b);return a},{mediaStagingsImage:[],mediaStagingsOther:[]});var b=a.mediaStagingsImage;a=a.mediaStagingsOther;return[].concat(b,a)}function b(a){var b=new Map();a=a.filter(function(a){return(h||(h=d("I64"))).equal(a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))});var e=a.length;if(e>1){var f=c("uuidv4")();a.forEach(function(a,c){b.set(d("MAWSendFileMsgTypes").toOfflineAttachmentIDFromString(a.offlineAttachmentId),{groupId:f,groupIndex:c,groupSize:e})})}return b}function e(a){var b=new Map(),d=a.length;if(d>1){var e=c("uuidv4")();a.forEach(function(a,c){b.set(a,{groupId:e,groupIndex:c,groupSize:d})})}return b}g.orderMediaStagingsForGrouping=a;g.generateMediaGroupMetadataForMediaStagings=b;g.generateMediaGroupMetadataForMessageIds=e}),98);
__d("MAWThreadId",["LSMessagingThreadTypeUtil","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));return a==null?void 0:a.threadType});return i.apply(this,arguments)}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield h(a,b));return a==null?!1:d("LSMessagingThreadTypeUtil").isArmadilloSecure(a)});return j.apply(this,arguments)}function c(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b))}g.isSecureThreadKey=a;g.getThread=c}),98);
__d("MAWForwardMessage",["MAWBridgeSendAndReceive","MAWCreateOneToOneThread","MAWExternalId","MAWGetEphemeralSettings","MAWGetProtocolMsgIdByMsgIdInUI","MAWMessageSendReporter","MAWMiActOnActThreadReady","MAWSecureAttachmentGroupingUtils","MAWThreadId","Promise","WAResultOrError","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c,d){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield d("MAWThreadId").isSecureThreadKey(a.tables,b));if(!f){f=(yield d("MAWCreateOneToOneThread").call(a,b,void 0,"MAWForwardMessage",e));e=f.jid;return c(e,!0)}f=(yield d("MAWMiActOnActThreadReady").waitForACTThreadReady(a.tables,b,"MAWForwardMessage"));e=f.chatJid;return c(e,!1)});return j.apply(this,arguments)}function a(a,b,c,d,e,f){return l(a,b,c,d,e,void 0,f)}function e(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var i=d("MAWSecureAttachmentGroupingUtils").generateMediaGroupMetadataForMessageIds(e);yield (h||(h=b("Promise"))).allSettled([e.map(function(b){return l(a,c,b,f,g,i.get(b))})])});return k.apply(this,arguments)}function l(a,b,e,f,g,h,j){var k=d("MAWExternalId").generateExternalId();return i(a,b,function(i,l){return d("MAWGetProtocolMsgIdByMsgIdInUI").getProtocolMsgIdByMsgIdUI(e).then(function(e){if(e!=null)return d("MAWGetEphemeralSettings").getEphemeralSetting(i,b).then(function(b){b=d("MAWBridgeSendAndReceive").sendAndReceive("backend","forwardMsg",{args:{args:{mediaGroupMetadata:h,source:f},chatJid:i,ephemeralSetting:b!=null?b:void 0,externalId:k,isFirstMsg:l,protocolMsgId:e,textWithSubstitutions:j},qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:g});return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:i,externalId:k},b,{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:g},a)});else return d("WAResultOrError").makeResult({description:"unexpected null protocolMsgId",messageType:"fixMe"})})},g)}g.maybeCreateNewThreadAndCallback=i;g.forwardMessage=a;g.forwardMessageBatch=e}),98);
__d("VideoFrameBuffer",["HTMLMediaElementReadyStates"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b,c,d,e,f,g){d===void 0&&(d=null),e===void 0&&(e=null),f===void 0&&(f=null),g===void 0&&(g=null),this.$2=b,this.$1=a,this.$3=c||"contain",this.$6=d,this.$7=e,this.$8=f,this.$9=g}var b=a.prototype;b.updateFrameBuffer=function(){this.$4&&(this.$1.width=this.$4,this.$4=null);this.$5&&(this.$1.height=this.$5,this.$5=null);if(this.$2.readyState<c("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)return;var a=this.$1.clientWidth||this.$1.width,b=this.$1.clientHeight||this.$1.height,d=a,e=b,f=this.$2.videoWidth/this.$2.videoHeight,g=d/e;this.$3==="cover"&&(g*=-1,f*=-1);g>f?d=e*f:g<f&&(e=d/f);g=this.$1.getContext("2d");if(!(g instanceof window.CanvasRenderingContext2D))return;try{if(this.$6||this.$7){g.drawImage(this.$2,(f=this.$8)!=null?f:0,(f=this.$9)!=null?f:0,(f=this.$6)!=null?f:a,(f=this.$7)!=null?f:b,0,0,a,b)}else g.drawImage(this.$2,(a-d)/2,(b-e)/2,d,e)}catch(a){if(a.name!=="NS_ERROR_NOT_AVAILABLE")throw a}};b.getDOMNode=function(){return this.$1};b.updateDimensions=function(a,b){this.$4=a,this.$5=b};return a}();g["default"]=a}),98);
__d("generateVideoThumbnails",["CPXComposerConstants","CanvasVideoThumbnail","HTMLMediaElementReadyStates","Promise","VideoFrameBuffer","cr:909281"],(function(a,b,c,d,e,f,g){var h,i=.5625;function a(a,d,e,f,g,i,o,p,q,r){g===void 0&&(g="contain");i===void 0&&(i=0);o===void 0&&(o=null);p===void 0&&(p=null);q===void 0&&(q=null);r===void 0&&(r=null);return new(h||(h=b("Promise")))(function(h,s){var t=document.createElement("canvas"),u=[],v=0,w=a.duration-i;r!=null&&(w=Math.min(w,r));var x=w/f,y=null,z=null,A,B=p!=null?p:j(o,d),C=q!=null?q:k(o,e),D=l(o,d),E=m(o,e);t.width=B!=null?B:d;t.height=C!=null?C:e;var F=new(c("VideoFrameBuffer"))(t,a,g,B,C,D,E);F.updateFrameBuffer();var G=function(){F.updateFrameBuffer();var b=new(c("CanvasVideoThumbnail"))(t,a,i+(v-1)*x,B,C,D,E);u.push(b);(!y||b.getURL().length>y.getURL().length)&&(y=b,z=n(o,a));I()},H=function(){if(a.readyState>=c("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)G();else if(b("cr:909281")!==null)var d=b("cr:909281").listen(a,"loadeddata",function(){d.remove(),G()});else a.addEventListener("loadeddata",G,{once:!0})},I=function(){v===0&&(b("cr:909281")!==null?A=b("cr:909281").listen(a,"seeked",H):a.addEventListener("seeked",H)),v<f?(a.currentTime=i+v*x,v++):(b("cr:909281")!==null?A&&A.remove():a.removeEventListener("seeked",H),h({thumbnails:u,selectedThumbnail:y,croppedThumbnailUri:z}))};if(a.videoWidth===0||a.videoHeight===0){s();return}I()})}function j(a,b){if(a&&a.spherical){if(a.stereoMode==="left-right")return b/2;if(a.projectionType==="cubemap")return b/3}return null}function k(a,b){return a&&a.spherical&&(a.stereoMode==="top-bottom"||a.projectionType==="cubemap")?b/2:null}function l(a,b){return a&&a.spherical&&a.projectionType==="cubemap"?b/3:0}function m(a,b){return a&&a.spherical&&a.projectionType==="cubemap"?b/2:0}function n(a,b){var c=b.videoWidth!=null&&b.videoHeight!=null?b.videoWidth/b.videoHeight:i,e=c<1;if(a==null&&!e){a=document.createElement("canvas");e=a.getContext("2d");var f=b.videoWidth,g=b.videoHeight;a.width=f;a.height=g;e.drawImage(b,0,0,f,g);e=document.createElement("canvas");c>=1&&c<1.2?(b=f*(d("CPXComposerConstants").REEL_THUMBNAIL_WIDTH/d("CPXComposerConstants").REEL_THUMBNAIL_HEIGHT),c=g):(b=g,c=f);e.width=b;e.height=c;var h=e.getContext("2d");h.drawImage(a,0,0,f,g,0,0,b,c);return e.toDataURL("image/jpeg")}return null}g["default"]=a}),98);
__d("MAWVideoUtils",["FBLogger","MAWImageUtils","Promise","generateVideoThumbnails"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var e=document.body;if(!e)return new(h||(h=b("Promise")))(function(a,b){return b("Unable to find DOM body, please use this util only in DOM environment.")});var f=document.createElement("video");return new(h||(h=b("Promise")))(function(d,g){f.setAttribute("style","display: none"),f.setAttribute("src",URL.createObjectURL(a)),f.addEventListener("loadedmetadata",function(a){a=a.currentTarget;if(a instanceof HTMLVideoElement){var e=a.duration,i=a.videoHeight;a=a.videoWidth;var j=c("generateVideoThumbnails")(f,a,i,1);d((h||(h=b("Promise"))).all([j,a,i,Math.round(e)]))}else g("EventTarget returned for event should be HTMLVideoElement")}),f.addEventListener("error",function(a){g("Unable to load video")}),e.appendChild(f)}).then(function(a){var b=a[0],c=a[1],g=a[2],h=a[3];e.removeChild(f);return d("MAWImageUtils").canvasToBlob(b.thumbnails[0].getCanvas(),d("MAWImageUtils").TYPE_JPEG,!0).then(function(a){return a.arrayBuffer().then(function(a){return{duration:h,height:g,jpegThumbnail:a,width:c}})})})["catch"](function(a){e.removeChild(f);throw c("FBLogger")("messenger_web").mustfixThrow(a)})}function e(a){var d=document.body;if(!d)return new(h||(h=b("Promise")))(function(a,b){return b("Unable to find DOM body, please use this util only in DOM environment.")});var e=document.createElement("video");return new(h||(h=b("Promise")))(function(b,c){e.setAttribute("style","display: none"),e.setAttribute("src",URL.createObjectURL(a)),e.addEventListener("loadedmetadata",function(a){a=a.currentTarget;if(a instanceof HTMLVideoElement){var d=a.duration,e=a.videoHeight;a=a.videoWidth;b({duration:Math.round(d),height:e,width:a})}else c("EventTarget returned for event should be HTMLVideoElement")}),e.addEventListener("error",function(a){c("Unable to load video")}),d.appendChild(e)})["catch"](function(a){d.removeChild(e);throw c("FBLogger")("messenger_web").mustfixThrow(a)})}g.getVideoThumbnailUrlAndSpec=a;g.getVideoThumbnailSpec=e}),98);
__d("MAWFowardMessageFromOpenThread",["FBLogger","I64","LSIntEnum","MAWBridgeSendAndReceive","MAWDocumentPreProcess","MAWFetchXMABlob","MAWFetchXMAData","MAWFetchXMADataUtils","MAWForwardMessage","MAWGetEphemeralSettings","MAWGetImageSpec","MAWImagePreProcess","MAWMessageSendReporter","MAWUnshimUrl","MAWVideoUtils","MessagingAttachmentType","Promise","ReQL","WAArmadilloXMA.pb","WABlobToArrayBuffer","asyncToGeneratorRuntime","qpl","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="369239263222822",l="369239343222814",m="369239383222810";function n(a){return a===k||a===l||a===m}function o(a,c){return(j||(j=b("Promise"))).all([d("MAWGetImageSpec").getImageSpec_DEPRECATED(a),j.resolve(a),c.arrayBuffer(),d("MAWGetImageSpec").getImageSpec_DEPRECATED(c)]).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0],c=a[1],e=a[2];a=a[3];return{file:c,imageSpec:b,plaintext:yield d("WABlobToArrayBuffer").blobToArrayBuffer(c),thumbnailUrlAndSpec:{duration:void 0,height:a.height,jpegThumbnail:e,width:a.width},type:"image"}});return function(b){return a.apply(this,arguments)}}())}function p(a){return d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(a).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){return{file:a,plaintext:yield d("WABlobToArrayBuffer").blobToArrayBuffer(a),thumbnailUrlAndSpec:b,type:"video"}});return function(a){return c.apply(this,arguments)}}())}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFowardMessageFromOpenThread",url:a}));b=a==null?void 0:new File([a],b,{type:a.type});a=b!=null?yield d("MAWGetImageSpec").getImageSpec_DEPRECATED(b):null;return b!=null&&a!=null?{file:b,height:a.height,width:a.width}:void 0});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.tables.attachment_ctas).getKeyRange(a)));return c==null||b==null&&c.actionUrl==null?null:{actionUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,title:b!=null?b:void 0}});return t.apply(this,arguments)}function u(a,b,c,d){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){var g=(yield w(b,e));if((g==null?void 0:g.actionUrl)==null){d("sendToSentQPLLogger").markSendToSentFail(f,"null_xma_url");throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads without a defaultCTA and actionUrl")}a=(yield d("MAWFetchXMAData").fetchXMAData(a,g.actionUrl,[f]));if(a.linkType==="unknown"){d("sendToSentQPLLogger").markSendToSentFail(f,"unknown_xma_link_type");throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads with an unknown link type")}if(a.linkType==="external")return A(b,g,e,a);else return y(a,f)});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.actionUrl,e=a.defaultCtaId;a=a.defaultCtaTitle;if(e==null)return null;e=(yield s(e,a,b));return e!=null?e:{actionUrl:c!=null?c:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:c!=null?c:void 0,title:a!=null?a:void 0}});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("MAWFetchXMADataUtils").makeXMAFileArgs(a,b));var c=a.contentRef,e=a.ctas,f=a.defaultCTA,g=a.overlayIconGlyph,h=a.subtitle_text,i=a.title_text;a=a.xma_message_type;c={contentRef:c,ctas:e,defaultCTA:f,overlayIconGlyph:g,subtitleText:h,titleText:i};return babelHelpers["extends"]({},b,{xmaArgs:c,xmaMessageType:a!=null?a:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE})});return z.apply(this,arguments)}function A(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=a.attachmentCta1Id,i=a.attachmentCta2Id,k=a.attachmentCta3Id,l=a.cta1Title,m=a.cta2Title,n=a.cta3Title,o=a.faviconUrl,p=a.headerImageUrl,r=a.headerTitle,t=a.maxSubtitleNumOfLines,u=a.maxTitleNumOfLines,v=a.previewUrl,w=a.subtitleText;a=a.titleText;o=(yield (j||(j=b("Promise"))).all([[o,"favicon"],[p,"headerImage"],[v,"preview"]].map(function(a){return q(a[0],a[1])})));p=o[0];v=o[1];o=o[2];var x=[];if(g!=null){g=(yield s(g,l,e));g!=null&&x.push(g)}if(i!=null){l=(yield s(i,m,e));l!=null&&x.push(l)}if(k!=null){g=(yield s(k,n,e));g!=null&&x.push(g)}i={contentRef:f.contentRef,ctas:x.map(function(a){return babelHelpers["extends"]({},a,{actionUrl:d("MAWUnshimUrl").unshimUrl(a.actionUrl),nativeUrl:d("MAWUnshimUrl").unshimUrl(a.nativeUrl)})}),defaultCTA:babelHelpers["extends"]({},c,{actionUrl:d("MAWUnshimUrl").unshimUrl(c.actionUrl),nativeUrl:d("MAWUnshimUrl").unshimUrl(c.nativeUrl)}),headerTitle:r,maxSubtitleNumOfLines:(h||(h=d("I64"))).to_int32(t!=null?t:(h||(h=d("I64"))).zero),maxTitleNumOfLines:h.to_int32(u!=null?u:(h||(h=d("I64"))).zero),overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,subtitleText:w,titleText:a};return{faviconFileArgs:p,headerFileArgs:v,previewFileArgs:o,xmaArgs:i,xmaMessageType:f.xma_message_type}});return B.apply(this,arguments)}function C(a){var e=a.attachmentType,f=a.filename,g=a.playableDurationMs,k=a.playableUrl,l=a.playableUrlMimeType,m=a.previewUrl,n=a.previewUrlMimeType;if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))){if(k==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this attachment");var q=(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE));if(m!=null){a=q?m+"&":k;var r=q?m+"&":m;return(j||(j=b("Promise"))).all([window.fetch(a).then(function(a){return a.blob()}),window.fetch(r).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:q?n:l});a=new File([a],"previewForwardedFromOpenThread",{type:n});if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return o(b,a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))return p(b);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return o(b,a);throw c("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}a=q?k+"&":k;return window.fetch(a).then(function(a){return a.blob()}).then(function(a){if(q&&l==="video/mp4")throw c("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is only mp4 url for gif");a=new File([a],f!=null?f:"mediaForwardedFromOpenThread",{type:l});if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return d("MAWImagePreProcess").imagePreprocess(a,!1);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))return p(a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)))return d("MAWDocumentPreProcess").documentPreprocess(a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return(j||(j=b("Promise"))).all([d("MAWImagePreProcess").getJpegThumbnailInfo(a,400),d("MAWGetImageSpec").getImageSpec_DEPRECATED(a),j.resolve(a)]).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0],c=a[1];a=a[2];return{file:a,imageSpec:c,plaintext:yield d("WABlobToArrayBuffer").blobToArrayBuffer(a),thumbnailUrlAndSpec:b,type:"image"}});return function(b){return a.apply(this,arguments)}}());throw c("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO))){if(k!=null)return window.fetch(k+"&").then(function(a){return a.blob()}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=new File([a],"mediaForwardedFromOpenThread",{type:l});return{durations:(h||(h=d("I64"))).to_int32(g!=null?g:(h||(h=d("I64"))).zero)/1e3,file:a,isPtt:!0,plaintext:yield d("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"audio"}});return function(b){return a.apply(this,arguments)}}());throw c("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this audio attachment")}if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER))){if(k==null&&m==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no url for this sticker");return k!=null?m!=null?(j||(j=b("Promise"))).all([window.fetch(k).then(function(a){return a.blob()}),window.fetch(m).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:l});a=new File([a],"previewForwardedFromOpenThread",{type:n});return o(b,a)}):window.fetch(k).then(function(a){return a.blob()}).then(function(a){a=new File([a],"mediaForwardedFromOpenThread",{type:l});return o(a,a)}):window.fetch(m).then(function(a){return a.blob()}).then(function(a){return d("MAWImagePreProcess").imagePreprocess(new File([a],"previewForwardedFromOpenThread",{type:n}),!0)})}throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding other media types. Received attachment %d",(i||(i=d("LSIntEnum"))).toNumber(e))}function a(a,e,f,g,j,k,l,m,o){return d("MAWForwardMessage").maybeCreateNewThreadAndCallback(e,f,function(p,q){var r=d("MAWGetEphemeralSettings").getEphemeralSetting(p,f),s=q;return r.then(function(f){if(k!=null){if(n(k.attachmentFbid)){var q=d("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:"\ud83d\udc4d",ephemeralSetting:f!=null?f:void 0,isFirstMsg:s,isForwarded:j,source:l,specialTextSize:1},chatJid:p,externalId:o,qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m});return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:p,externalId:o},q,{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m},e)}return(h||(h=d("I64"))).equal(k.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?u(a,k,e,m).then(function(a){var b=a.faviconFileArgs,h=a.headerFileArgs,i=a.previewFileArgs,j=a.xmaArgs;a=a.xmaMessageType;a=d("MAWBridgeSendAndReceive").sendAndReceive("backend","sendXMAShareMsg",{args:{content:g.text,ephemeralSetting:f!=null?f:void 0,isFirstMsg:s,isForwarded:!0,xmaMessageType:a!=null?a:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},chatJid:p,faviconFile:b,headerFile:h,previewFile:i,qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m,xmaArgs:j,xmaMsgExternalId:o});return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:p,externalId:o},a,{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m},e)}):C(k).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;switch(a.type){case"image":var g=a.imageSpec,h=a.thumbnailUrlAndSpec;b={args:{ephemeralSetting:f!=null?f:void 0,height:g.height,isFirstMsg:s,isForwarded:j,jpegThumbnail:h==null?void 0:h.jpegThumbnail,jpegThumbnailHeight:h==null?void 0:h.height,jpegThumbnailWidth:h==null?void 0:h.width,source:l,width:g.width},attachmentType:"image",chatJid:p,externalId:o};break;case"video":h=a.thumbnailUrlAndSpec;b={args:{duration:h.duration,ephemeralSetting:f!=null?f:void 0,height:h.height,isFirstMsg:s,isForwarded:j,jpegThumbnail:h.jpegThumbnail,jpegThumbnailHeight:h.height,jpegThumbnailWidth:h.width,source:l,width:h.width},attachmentType:"video",chatJid:p,externalId:o};break;case"audio":g=a.durations;h=a.isPtt;b={args:{duration:Math.round(g),ephemeralSetting:f!=null?f:void 0,isFirstMsg:s,isForwarded:j,isPtt:h,source:l},attachmentType:"audio",chatJid:p,externalId:o};break;case"document":b={args:{ephemeralSetting:f!=null?f:void 0,filename:a.filename,isFirstMsg:s,isForwarded:j,source:l},attachmentType:"application",chatJid:p,externalId:o};break}if(b==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this attachment type: %s",a.type);h=d("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMediaMsgV2",babelHelpers["extends"]({},b,{mimeType:a.file.type,plaintext:(g=a.plaintext)!=null?g:yield d("WABlobToArrayBuffer").blobToArrayBuffer(a.file),qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m}));return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:p,externalId:o},h,{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m},e)});return function(b){return a.apply(this,arguments)}}())}q=g.text;if(q!=null){q=d("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:g.text,ephemeralSetting:f!=null?f:void 0,isFirstMsg:s,isForwarded:j,source:l},chatJid:p,externalId:o,qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m});return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:p,externalId:o},q,{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:m},e)}throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this types")})},m)}g.downloadMediaByUrl=C;g.forwardMessage=a}),98);
__d("LSLocalApplyOptimisticMessageWithAttachments",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],a[4],a[5],a[6],void 0,a[7],a[8],a[9],a[10],void 0,a[12],!0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return d[2]=c.i64.of_int32(a[11].length),c.i64.gt(d[2],c.i64.cast([0,0]))?c.loopAsync(d[2],function(e){return d[3]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[11],d[3]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(b){return d[6]=d[4].get("attachment_fbid"),d[7]=d[4].get("offline_attachment_id"),d[8]=d[4].get("attachment_type"),d[9]=d[4].get("filename"),d[10]=d[4].get("filesize"),d[11]=d[4].get("attachment_index"),d[12]=d[4].get("has_media"),d[13]=d[4].get("has_xma"),d[14]=d[4].get("playable_url"),d[15]=d[4].get("playable_url_mime_type"),d[16]=d[4].get("playable_duration_ms"),d[17]=d[4].get("preview_url"),d[18]=d[4].get("preview_url_mime_type"),d[19]=d[4].get("mini_preview"),d[20]=d[4].get("preview_width"),d[21]=d[4].get("preview_height"),d[22]=d[4].get("xma_layout_type"),d[23]=d[4].get("xmas_template_type"),d[24]=d[4].get("cta1_title"),d[25]=d[4].get("cta2_title"),d[26]=d[4].get("cta3_title"),d[27]=d[4].get("image_url"),d[28]=d[4].get("action_url"),d[29]=d[4].get("title_text"),d[30]=d[4].get("subtitle_text"),d[31]=d[4].get("description_text"),d[32]=d[4].get("source_text"),d[33]=d[4].get("original_file_hash"),d[34]=d[4].get("sound_bite_client_sound_key"),d[35]=d[4].get("sound_bite_visual"),d[36]=d[4].get("ephemeral_media_state"),d[37]=d[4].get("waveform_data"),d[38]=d[4].get("sampling_frequency_hz"),d[17]!==void 0?d[39]=d[17]:d[39]=d[14],c.filter(c.db.table(16).fetch([[[a[1],d[0],d[6]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===d[0]&&b.attachmentFbid===d[6]&&c.i64.gt(b.authorityLevel,c.i64.cast([0,20]))}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(16).put({threadKey:a[1],messageId:d[0],attachmentFbid:d[6],timestampMs:d[1],offlineAttachmentId:d[7],attachmentType:d[8],filename:d[9],filesize:d[10],attachmentIndex:d[11],hasMedia:d[12],hasXma:d[13],isSharable:!1,playableUrl:d[14],playableUrlMimeType:d[15],playableDurationMs:d[16],previewUrl:d[39],previewUrlMimeType:d[18],miniPreview:d[19],previewWidth:d[20],previewHeight:d[21],xmaLayoutType:d[22],xmasTemplateType:d[23],cta1Title:d[24],cta2Title:d[25],cta3Title:d[26],imageUrl:d[27],actionUrl:d[28],titleText:d[29],subtitleText:d[30],descriptionText:d[31],sourceText:d[32],ephemeralMediaState:d[36],originalFileHash:d[33],authorityLevel:c.i64.cast([0,20]),samplingFrequencyHz:d[38],waveformData:d[37]}):0})}])}):c.resolve()},function(e){return d[2]=c.i64.of_int32(a[11].length),c.i64.gt(d[2],c.i64.cast([0,0]))?c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[0],d[1],a[3],!1,c.i64.neq(a[6],void 0)):c.resolve()},function(a){return a=[d[0],d[1]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticMessageWithAttachmentsStoredProcedure";a.__tables__=["attachments"];e.exports=a}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",["LSLocalApplyOptimisticMessageWithAttachments","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSLocalApplyOptimisticMessageWithAttachments"),e.senderId,e.threadKey,e.threadType,e.text,e.snippet,e.snippetHasEmoji,e.stickerId,e.replySourceId,e.replySourceType,e.replySourceTypeV2,e.isForwarded,e.attachments,e.mentionData);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticSendXMAMessageForwardFromSecureThread",["LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,3]),a[4],void 0,void 0,!0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return d[3]=c.i64.of_int32(a[6].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[4]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[6],d[4]).then(function(a){return a=a,d[5]=a[0],d[6]=a[1],a})},function(e){return d[7]=d[5].get("attachment_fbid"),d[8]=d[5].get("offline_attachment_id"),d[9]=d[5].get("attachment_type"),d[10]=d[5].get("filename"),d[11]=d[5].get("filesize"),d[12]=d[5].get("attachment_index"),d[13]=d[5].get("has_media"),d[14]=d[5].get("has_xma"),d[15]=d[5].get("playable_url"),d[16]=d[5].get("playable_url_mime_type"),d[17]=d[5].get("playable_duration_ms"),d[18]=d[5].get("preview_url"),d[19]=d[5].get("preview_url_mime_type"),d[20]=d[5].get("mini_preview"),d[21]=d[5].get("preview_width"),d[22]=d[5].get("preview_height"),d[23]=d[5].get("xma_layout_type"),d[24]=d[5].get("xmas_template_type"),d[25]=d[5].get("cta1_title"),d[26]=d[5].get("cta2_title"),d[27]=d[5].get("cta3_title"),d[28]=d[5].get("image_url"),d[29]=d[5].get("action_url"),d[30]=d[5].get("title_text"),d[31]=d[5].get("subtitle_text"),d[32]=d[5].get("description_text"),d[33]=d[5].get("source_text"),d[34]=d[5].get("original_file_hash"),d[35]=d[5].get("sound_bite_client_sound_key"),d[36]=d[5].get("sound_bite_visual"),d[37]=d[5].get("ephemeral_media_state"),c.sequence([function(b){return c.forEach(c.filter(c.db.table(16).fetch([[[a[1],d[0],d[7]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===d[0]&&b.attachmentFbid===d[7]&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(16).add({threadKey:a[1],messageId:d[0],attachmentFbid:d[7],timestampMs:d[1],offlineAttachmentId:d[8],attachmentType:d[9],filename:d[10],filesize:d[11],attachmentIndex:d[12],hasMedia:d[13],hasXma:d[14],isSharable:!1,playableUrl:d[15],playableUrlMimeType:d[16],playableDurationMs:d[17],previewUrl:d[18],previewUrlMimeType:d[19],miniPreview:d[20],previewWidth:d[21],previewHeight:d[22],xmaLayoutType:d[23],xmasTemplateType:d[24],cta1Title:d[25],cta2Title:d[26],cta3Title:d[27],imageUrl:d[28],actionUrl:d[29],titleText:d[30],subtitleText:d[31],descriptionText:d[32],sourceText:d[33],ephemeralMediaState:d[37],originalFileHash:d[34],authorityLevel:c.i64.cast([0,20])})},function(e){return c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[0],d[1],a[3],!1,!1)},function(e){return c.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[0],d[7],d[15],void 0,void 0,d[16],d[18],void 0,void 0,d[19],d[21],d[22],d[30])}])}])}):c.resolve()},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[2],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[5],sendType:c.i64.cast([0,11]),markThreadRead:!1})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure";a.__tables__=["attachments","messages_optimistic_context"];e.exports=a}),null);
__d("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",["LSOptimisticSendXMAMessageForwardFromSecureThread","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendXMAMessageForwardFromSecureThread"),e.senderId,e.threadKey,e.threadType,e.text,e.isForwarded,e.source,e.attachments);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWForwardMessageFromSecureThread.react",["FBLogger","I64","LSFactory","LSHotEmojiSize","LSInsertNewMediaSendStoredProcedure","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure","LSMailboxType","LSMarkSubJobCompletedV2StoredProcedure","LSOptimisticSendMessageV2StoredProcedure","LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure","LSShape","LSVec","MAWBridgeSendAndReceive","MAWDbMedia","MAWMpsGating","MWPComposerMediaUploadUtil","MWPOpenComposerUtils","MessagePowerUp","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","WAHashUtils","asyncToGeneratorRuntime","cr:2472","cr:332","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=function(){return c("gkx")("11351")||d("MAWMpsGating").isFullMpsEnabled()};function l(a,b,c){return{action_url:void 0,attachment_fbid:b,attachment_index:(j||(j=d("I64"))).zero,attachment_type:a.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:a.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:b,original_file_hash:void 0,playable_duration_ms:a.playableDurationMs,playable_url:URL.createObjectURL(c),playable_url_mime_type:c.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,source_text:void 0,subtitle_text:void 0,title_text:void 0,xma_layout_type:void 0,xmas_template_type:void 0}}function m(a,b,c,e){var f;return{action_url:(f=b==null?void 0:b.actionUrl)!=null?f:b==null?void 0:b.nativeUrl,attachment_fbid:c,attachment_index:(j||(j=d("I64"))).zero,attachment_type:a.attachmentType,cta1_title:a.cta1Title,cta2_title:a.cta2Title,cta3_title:a.cta3Title,description_text:a.descriptionText,filename:a.filename,filesize:a.filesize,has_media:!1,has_xma:!0,image_url:void 0,mini_preview:void 0,offline_attachment_id:c,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:e!=null?URL.createObjectURL(e):void 0,playable_url_mime_type:e==null?void 0:e.type,preview_height:void 0,preview_url:e!=null?URL.createObjectURL(e):void 0,preview_url_mime_type:e==null?void 0:e.type,preview_width:void 0,source_text:a.sourceText,subtitle_text:a.subtitleText,title_text:a.titleText,xma_layout_type:a.xmaLayoutType,xmas_template_type:a.xmasTemplateType}}function n(a,e,f,g,i,j,k,l){l=c("LSFactory")(l);return c("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure")(l,{attachments:c("LSVec").ofArray([d("LSShape").ofRecord(j)]),isForwarded:i,senderId:a,source:k,text:g!=null?g:void 0,threadKey:e,threadType:f}).then(function(){return(h||(h=b("Promise"))).resolve()})}function o(a,b){return a==null||b==null?void 0:{amplitudes:b.split(",").map(parseFloat),sampling_freq:a}}function p(a,e,g,k,l,m,n,p,q){var r=c("LSFactory")(p);return c("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure")(r,{attachments:c("LSVec").ofArray([d("LSShape").ofRecord(e)]),isForwarded:m,senderId:n,threadKey:l,threadType:k}).then(function(a){var c=a[0];a[1];return p.messages_optimistic_context.add({externalAttachmentUrl:void 0,initiatingSource:void 0,markThreadRead:!1,messageId:void 0,offlineThreadingId:c,platformRef:void 0,platformToken:void 0,replySourceId:void 0,replySourceType:void 0,sendType:void 0,skipUrlPreviewGen:void 0,taskId:(j||(j=d("I64"))).of_string(c),threadAttributionSource:q,threadKey:l}).then(function(){return(h||(h=b("Promise"))).resolve(c)})}).then(function(a){var f=e.attachment_fbid;return c("LSInsertNewMediaSendStoredProcedure")(r,{attachmentType:e.attachment_type,inMessageIndex:(j||(j=d("I64"))).zero,isSecure:!1,offlineAttachmentId:f,offlineThreadingId:a,sendByServer:!1,shouldTranscode:!1,useDoublePhase:!1}).then(function(){return(h||(h=b("Promise"))).resolve([a,f])})}).then(function(b){var h=b[0],k=b[1];b=function(b,e){if(e==null||e.length===0)return;c("promiseDone")(a.runInTransaction(function(a){var b=c("LSFactory")(a);return c("LSMarkSubJobCompletedV2StoredProcedure")(b,{fbid:(j||(j=d("I64"))).of_string(e),offlineAttachmentId:k}).then(function(){return d("MWPOpenComposerUtils").resumeSendJob(b,h)})},"readwrite",void 0,void 0,f.id+":226"))};return d("MWPComposerMediaUploadUtil").startUpload(void 0,void 0,b,void 0,(j||(j=d("I64"))).equal(e.attachment_type,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)),[g],[k],void 0,void 0,o(e.sampling_frequency_hz,e.waveform_data),void 0,void 0)})}function a(a,b,c,d,e,f,g,h,i){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g,q,r,s,t,u,v){if(s!=null){var w=s.attachmentType;if(!((j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO))||(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))||(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))))throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var x=null;if(!(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))){isFinite(s.attachmentFbid)?x=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:d("MAWDbMedia").convertNumberToMediaId(Number.parseInt(s.attachmentFbid,10))})):x=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:d("WAHashUtils").stringToPlaintextHash(s.attachmentFbid)}).then(function(a){b("cr:332")!=null&&void b("cr:332").runBlobReadAndCompareResult({fileName:s.attachmentFbid,idbBlob:a});return a}));if(x==null)return}yield a.runInTransaction(function(f){switch(!0){case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)):if(x==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");var y=new File([x],"mediaForwardedFromSecureThread",{type:x.type}),z=d("OfflineThreadingId").createOfflineThreadingID();z=d("MWPComposerMediaUploadUtil").getAudioAttachment(z,y,(j||(j=d("I64"))).to_int32((z=s.playableDurationMs)!=null?z:(j||(j=d("I64"))).zero)/1e3,o(s.samplingFrequencyHz!=null?(j||(j=d("I64"))).to_int32(s.samplingFrequencyHz):void 0,s.waveformData));return p(a,z,y,g,e,r,t,f,u);case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA)):return d("ReQL").firstAsync(d("ReQL").fromTableDescending(f.attachment_ctas).getKeyRange((z=s.defaultCtaId)!=null?z:(j||(j=d("I64"))).zero)).then(function(a){var e,f=s.xmaPreviewFbid;if(f==null){c("FBLogger")("messenger_web_sharing").mustfix("XMA preview fbid is null when forwarding XMA");return(h||(h=b("Promise"))).resolve([a,void 0])}if(k())e=d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:d("WAHashUtils").stringToPlaintextHash(f)}).then(function(a){b("cr:332")!=null&&void b("cr:332").runBlobReadAndCompareResult({fileName:s.attachmentFbid,idbBlob:a});return a});else if(c("gkx")("7858"))isFinite(s.xmaPreviewFbid)?(c("FBLogger")("messenger_web_sharing").warn("XMA preview fbid is not a plaintextHash when forwarding XMA"),e=d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:d("MAWDbMedia").convertNumberToMediaId(Number.parseInt(f,10))})):e=d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:d("WAHashUtils").stringToPlaintextHash(f)}).then(function(a){b("cr:332")!=null&&void b("cr:332").runBlobReadAndCompareResult({fileName:s.attachmentFbid,idbBlob:a});return a});else try{e=d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:d("MAWDbMedia").convertNumberToMediaId(Number.parseInt(f,10))})}catch(d){c("FBLogger")("messenger_web_sharing").mustfix("XMA preview fbid is not a valid mediaId when forwarding XMA %s",d);return(h||(h=b("Promise"))).resolve([a,void 0])}return e.then(function(c){return(h||(h=b("Promise"))).resolve([a,c])})["catch"](function(d){c("FBLogger")("messenger_web_sharing").catching(d).warn("Unable to getBlobDataUrlByXMAId, from MAWForwardMessageFromSecureThread");return(h||(h=b("Promise"))).resolve([a,void 0])})}).then(function(a){var c=a[0];a=a[1];var h=null;a!=null&&(h=new File([a],"xmaForwardedFromSecureThread",{type:a.type}));a=d("OfflineThreadingId").createOfflineThreadingID();c=m(s,c,a,h);a=q.text;h=b("cr:2472")==null||a==null?a:b("cr:2472").unvault(a);return n(t,e,g,v!=null?v:h,r,c,u,f)});case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)):case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)):case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)):case(j||(j=d("I64"))).equal(w,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)):if(x==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");z=new File([x],(y=s.filename)!=null?y:"mediaForwardedFromSecureThread",{type:x.type});y=d("OfflineThreadingId").createOfflineThreadingID();y=l(s,y,z);return p(a,y,z,g,e,r,t,f,u);default:throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type")}},"readwrite",void 0,void 0,f.id+":341")}else{var y=q.text;if(y==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var z=b("cr:2472")==null?y:b("cr:2472").unvault(y),A=z==="\ud83d\udc4d"&&q.hotEmojiSize!=null&&(j||(j=d("I64"))).equal(q.hotEmojiSize,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").SMALL)),B=A?(j||(j=d("I64"))).of_string("369239263222822"):void 0;yield a.runInTransaction(function(a){return c("LSOptimisticSendMessageV2StoredProcedure")(c("LSFactory")(a),{extraSendMessageParams:d("LSShape").ofRecord({calculate_denormalizations:!1,is_forwarded:r,mark_read:!1,power_up_style:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagePowerUp").NONE),source:u,sticker_id:B}),mailboxType:i.ofNumber(c("LSMailboxType").MESSENGER),senderId:t,text:A?void 0:v!=null?v:z,threadKey:e,threadType:g})},"readwrite",void 0,void 0,f.id+":586")}});return q.apply(this,arguments)}g.getMediaAttachment=l;g.uploadAndSendMediaToOpenThread=p;g.forwardMessage=a}),98);
__d("forwardAttachmentFromInstamadilloToOpen",["I64","LSIntEnum","MAWForwardMessageFromSecureThread.react","OfflineThreadingId","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentFromInstamadilloToOpen");function a(a,b,c,d,e,f){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){var k=(yield j.load()),l=(yield k());k=d("OfflineThreadingId").createOfflineThreadingID();var m={attachment_fbid:k,attachment_index:(h||(h=d("I64"))).zero,attachment_type:a.attachmentType,filename:a.filename,has_media:!0,has_xma:!1,offline_attachment_id:k,playable_duration_ms:a.playableDurationMs,playable_url:URL.createObjectURL(b),playable_url_mime_type:b.type,preview_height:a.previewHeight,preview_url:URL.createObjectURL(b),preview_width:a.previewWidth};yield l.runInTransaction(function(a){return d("MAWForwardMessageFromSecureThread.react").uploadAndSendMediaToOpenThread(l,m,b,(i||(i=d("LSIntEnum"))).ofNumber(e),(h||(h=d("I64"))).of_string(c),!0,f,a,g)},"readwrite")});return k.apply(this,arguments)}g["default"]=a}),98);
__d("forwardAttachmentToInstamadillo",["I64","IGDBridgedAPI","LSFactory","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure","LSPendingTasksPluginType","LSShape","LSVec","OfflineThreadingId","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentToInstamadillo");function a(a,b,c,d,e,f,g){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k,l,m){var n=(yield j.load());n=(yield n());var o=d("OfflineThreadingId").createOfflineThreadingID(),p={attachment_fbid:o,attachment_index:(h||(h=d("I64"))).zero,attachment_type:a.attachmentType,filename:a.filename,has_media:!0,has_xma:!1,offline_attachment_id:o,playable_duration_ms:a.playableDurationMs,playable_url:URL.createObjectURL(e),playable_url_mime_type:e.type,preview_height:a.previewHeight,preview_url:URL.createObjectURL(e),preview_width:a.previewWidth};o=(yield n.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure")(c("LSFactory")(a),{extraSendMessageParams:d("LSShape").ofRecord({attachments:c("LSVec").ofArray([d("LSShape").ofRecord(p)]),is_forwarded:!0,mark_read:!1,plugin_type:(i||(i=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").IGD_INSTAMADILLO),source:l}),senderId:k,threadKey:(h||(h=d("I64"))).of_string(f),threadType:i.ofNumber(g)}));b=b[0];yield a.messages_optimistic_context.add({markThreadRead:!1,offlineThreadingId:b,openEb:m,taskId:h.of_string(b),threadAttributionSource:l,threadKey:h.of_string(f)});return b});return function(b){return a.apply(this,arguments)}}(),"readwrite"));yield c("IGDBridgedAPI").sendMediaMessage({offlineThreadingId:o});return o});return k.apply(this,arguments)}g["default"]=a}),98);
__d("LSOptimisticSendAttachmentForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[1]=a[3]===""?void 0:a[3],d[1]!==void 0?c.sequence([function(b){return c.forEach(c.filter(c.db.table(16).fetch([[[a[1],d[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===d[1]&&c.i64.eq(b.authorityLevel,c.i64.cast([0,20]))}),function(b){var d=b.update;b.item;return d({attachmentFbid:c.i64.to_string(a[7])})})},function(a){return d[0]=d[1]}]):c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[4],a[5],a[6],void 0,void 0,void 0,void 0,c.i64.cast([0,3]),void 0,void 0,void 0,!0).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return c.filter(c.db.table(16).fetch(),function(b){return b.attachmentFbid===c.i64.to_string(a[7])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),c.i64.cast([0,2]),void 0,c.i64.cast([0,0]),void 0,!0,!1):(f=e.item,c.sequence([function(e){return c.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),f.attachmentType,f.filename,f.attachmentIndex,f.attributionAppId,!0,!1)},function(e){return c.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[2],c.i64.to_string(a[7]),f.playableUrl,f.playableUrlFallback,f.playableUrlExpirationTimestampMs,f.playableUrlMimeType,f.previewUrl,f.previewUrlFallback,f.previewUrlExpirationTimestampMs,f.previewUrlMimeType,f.previewWidth,f.previewHeight,f.titleText)}]))})},function(a){return d[0]=d[2]}])},function(e){return c.sequence([function(b){return d[2]=c.createArray(),d[6]=(d[2].push(a[7]),d[2]),c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[3]=c.i64.cast([0,1]):(b=a.item,d[7]=b.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[3]=d[6])})},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),d[3],void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[5]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[5],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[8],sendType:c.i64.cast([0,4]),markThreadRead:!1,initiatingSource:a[9]})}])},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticSendAttachmentForwardStoredProcedure";a.__tables__=["attachments","threads","messages_optimistic_context"];e.exports=a}),null);
__d("LSOptimisticSendAttachmentForwardStoredProcedure",["LSOptimisticSendAttachmentForward","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendAttachmentForward"),e.senderId,e.threadKey,e.threadType,e.offlineThreadingId,e.text,e.snippet,e.snippetHasEmoji,e.forwardedAttachmentFbid,e.source,e.initiatingSource);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("forwardAttachmentToOpen",["I64","LSFactory","LSIntEnum","LSOptimisticSendAttachmentForwardStoredProcedure","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentToOpen");function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var k=(yield j.load());k=(yield k());k=(yield k.runInTransaction(function(j){return c("LSOptimisticSendAttachmentForwardStoredProcedure")(c("LSFactory")(j),{forwardedAttachmentFbid:(h||(h=d("I64"))).of_string(a.attachmentFbid),senderId:f,source:g,threadKey:h.of_string(b),threadType:(i||(i=d("LSIntEnum"))).ofNumber(e)})},"readwrite"));k=k[0];return k});return k.apply(this,arguments)}g["default"]=a}),98);
__d("forwardAttachment",["FBLogger","I64","MAWDbMedia","MAWFowardMessageFromOpenThread","Promise","asyncToGeneratorRuntime","forwardAttachmentFromInstamadilloToOpen","forwardAttachmentToInstamadillo","forwardAttachmentToOpen","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachment");function a(a,b,c,d,e,f){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k,l){var m=(yield j.load());m=(yield m());var n=(yield m.tables.e2ee_media.get(d("MAWDbMedia").convertToMediaId64((i||(i=d("I64"))).of_float(Number.parseInt(a.attachmentFbid,10))))),o=!1;if(n!=null){m=(yield m.tables.e2ee_chunk.index("hashedPlaintextHash").get(n.hashedPlaintextHash));if(m!=null){n=new Blob([m.blobData],{type:m.mimetype});m=new File([n],"IGDForwardFromSecureThread-"+a.attachmentFbid,{type:n.type});o=!0}else{c("FBLogger")("igd_web").mustfix("Missing chunk for e2ee media when forwarding an E2EE media message");return(h||(h=b("Promise"))).resolve()}}else{n=(yield d("MAWFowardMessageFromOpenThread").downloadMediaByUrl(a));m=n.file}if(Boolean(l==null?void 0:l.useInstamadilloTransport))return c("forwardAttachmentToInstamadillo")(a,m,e,f,g,k,Boolean(l==null?void 0:l.useOpenEb));else if(o)return c("forwardAttachmentFromInstamadilloToOpen")(a,m,e,f,g,k);else return c("forwardAttachmentToOpen")(a,e,f,g,k)});return k.apply(this,arguments)}g["default"]=a}),98);
__d("LSOptimisticSendMessageForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSPredefineTraceForTask","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.filter(c.db.table(12).fetch([[[a[3],a[4],a[5]]]]),function(b){return c.i64.eq(b.threadKey,a[3])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.timestampMs,a[4])&&b.messageId===a[5]&&c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[3]=c.createArray(),d[4]=(d[3].push("optimisticSendMessageForward msg not found"),d[3]),d[5]=(d[3].push(a[5]),d[3]),d[6]=c.toJSON(d[3]),function(a){c.logger(a).mustfix(a)}(d[6]),g=["",c.i64.cast([-1,4294967295])],d[0]=g[0],d[1]=g[1]):(f=e.item,c.sequence([function(e){return d[11]=f.forwardScore,d[3]=f.text,d[4]=d[11],c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],d[3],void 0,void 0,f.stickerId,f.hotEmojiSize,void 0,void 0,c.i64.cast([0,3]),void 0,d[4],void 0,!0).then(function(a){return a=a,d[5]=a[0],d[6]=a[1],a})},function(e){return c.forEach(c.db.table(16).fetch([[[f.threadKey,f.messageId]]]),function(e){var f=e.item;return c.sequence([function(e){return d[16]=f.attachmentFbid,d[12]=c.createArray(),d[13]=(d[12].push(d[16]),d[12]),d[14]=(d[12].push(d[5]),d[12]),d[15]=c.toJSON(d[12]),c.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],d[6],d[5],d[16],d[15],f.attachmentType,f.filename,f.attachmentIndex,void 0,f.hasMedia,f.hasXma)},function(e){return c.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[5],d[15],f.playableUrl,f.playableUrlFallback,f.playableUrlExpirationTimestampMs,f.playableUrlMimeType,f.previewUrl,f.previewUrlFallback,f.previewUrlExpirationTimestampMs,f.previewUrlMimeType,f.previewWidth,f.previewHeight,f.titleText)}])})},function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[7]=c.i64.cast([0,1]):(e=b.item,d[13]=e.syncGroup,c.i64.neq(d[13],void 0)?d[12]=d[13]:d[12]=c.i64.cast([0,1]),d[7]=d[12])})},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),d[7],void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[9]=a[0],a})},function(a){return void 0!==void 0?c.storedProcedure(b("LSPredefineTraceForTask"),void 0,d[9],c.i64.to_string(c.i64.cast([0,46])),d[5]):c.resolve()},function(b){return c.db.table(31).add({taskId:d[9],threadKey:a[1],offlineThreadingId:d[5],messageId:a[5],threadAttributionSource:a[6],sendType:c.i64.cast([0,5]),markThreadRead:!1,initiatingSource:a[7]})},function(b){return d[12]=new c.Map(),d[13]=d[12].set("optimisticSendMessageForward",a[1]),d[14]=d[12].set("fwdMsgID",a[5]),d[15]=c.toJSON(d[12]),d[10]=d[15],function(a){c.logger(a).info(a)}(d[10]),b=[d[5],d[9]],d[0]=b[0],d[1]=b[1]}]))})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticSendMessageForwardStoredProcedure";a.__tables__=["messages","attachments","threads","messages_optimistic_context"];e.exports=a}),null);
__d("LSOptimisticSendMessageForwardStoredProcedure",["LSOptimisticSendMessageForward","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendMessageForward"),e.senderId,e.threadKey,e.threadType,e.forwardedMsgThreadKey,e.forwardedMsgTimestampMs,e.forwardedMsgId,e.source,e.initiatingSource);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("forwardAttachmentCollectionToOpen",["I64","LSFactory","LSIntEnum","LSOptimisticSendMessageForwardStoredProcedure","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentCollectionToOpen");function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var k=(yield j.load());k=(yield k());k=(yield k.runInTransaction(function(j){return c("LSOptimisticSendMessageForwardStoredProcedure")(c("LSFactory")(j),{forwardedMsgId:a.messageId,forwardedMsgThreadKey:a.threadKey,forwardedMsgTimestampMs:a.timestampMs,initiatingSource:void 0,senderId:f,source:g,threadKey:(h||(h=d("I64"))).of_string(b),threadType:(i||(i=d("LSIntEnum"))).ofNumber(e)})},"readwrite"));k=k[0];return k});return k.apply(this,arguments)}g["default"]=a}),98);
__d("forwardText",["I64","LSFactory","LSIntEnum","LSMailboxType","LSOptimisticSendMessageV2StoredProcedure","LSPendingTasksPluginType","LSShape","MessagePowerUp","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardText"),k={calculate_denormalizations:!1,is_forwarded:!0,mark_read:!1,power_up_style:(h||(h=d("LSIntEnum"))).ofNumber(c("MessagePowerUp").NONE)};function a(a,b,c,d,e,f){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,l){var m=(yield j.load());m=(yield m());m=(yield m.runInTransaction(function(j){return c("LSOptimisticSendMessageV2StoredProcedure")(c("LSFactory")(j),{extraSendMessageParams:d("LSShape").ofRecord(babelHelpers["extends"]({},k,{openEb:l==null?void 0:l.useOpenEb,plugin_type:l!=null&&l.useInstamadilloTransport?(h||(h=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").IGD_INSTAMADILLO):void 0,source:g})),mailboxType:(h||(h=d("LSIntEnum"))).ofNumber(c("LSMailboxType").MESSENGER),senderId:f,text:a.text,threadKey:(i||(i=d("I64"))).of_string(b),threadType:h.ofNumber(e)})},"readwrite"));m=m[0];return m});return l.apply(this,arguments)}g["default"]=a}),98);
__d("forwardXMAFromInstamadillo",["asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("getSendPostToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo"),i=c("requireDeferred")("getSendProfileToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo"),j=c("requireDeferred")("getSendReelToInstamadilloRecipient").__setRef("forwardXMAFromInstamadillo");function a(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){if(b==null)return;b=JSON.parse(b);switch(b.__typename){case"XMSGIgReceiverFetchXmaFeedFetchParams":var e=(yield h.load());e=e(b.media_igid,void 0,c,d,!0);yield e(a.id,a.isDisappearingModeSettingOn,a.isTTLCMediaShareEnabled);break;case"XMSGIgReceiverFetchXmaClipFetchParams":e=(yield j.load());e=e(b.media_igid,void 0,c,d,!0);yield e(a.id,a.isDisappearingModeSettingOn,a.isTTLCMediaShareEnabled);break;case"XMSGIgReceiverFetchXmaProfileFetchParams":e=(yield i.load());e=e(b.igid,void 0,c,d,!0);yield e(a.id,a.isDisappearingModeSettingOn,a.isTTLCGenericXMAShareEnabled);break}});return k.apply(this,arguments)}g["default"]=a}),98);
__d("forwardXMAUtils",["FBLogger","IGDInstamadilloUtils","IGDThreadTTLCUtils","URI","isLinkshimURI"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){a=new(h||(h=c("URI")))(a);c("isLinkshimURI")(a)&&(a=new(h||(h=c("URI")))(a.getQueryData().u));return a.toString()}function j(a,b){return a==="igd_web_post_share"&&b.includes("instagram.com/p/")}function k(a,b){return a==="xma_open_native"&&b.includes("https://www.instagram.com")}function a(a,b,e,f){if(a==null)return!1;var g=d("IGDInstamadilloUtils").isInstamadilloMessage(b);if(g&&b.xmaReceiverFetchParams!=null){var h;try{h=JSON.parse(b.xmaReceiverFetchParams)}catch(a){c("FBLogger")("igd_web").mustfix("forwardXMAUtils: failed to parse message xmaReceiverFetchParams with error %s.",a);return!1}return d("IGDThreadTTLCUtils").isXmaReceiverFetchTTLCEnabled(h,a)}if(f==null||(f==null?void 0:f.actionUrl)==null)return!1;g=i(f.actionUrl);if(j(e==null?void 0:e.defaultCtaType,g))return d("IGDThreadTTLCUtils").isInstamadilloTTLCMediaShareEnabled(a);return k(e==null?void 0:e.defaultCtaType,g)?d("IGDThreadTTLCUtils").isInstamadilloTTLCGenericXmaEnabled(a):!1}g.linkshimDecode=i;g.isFeedXma=j;g.isProfileXma=k;g.shouldForwardXMAViaTTLC=a}),98);
__d("forwardXMAFromOpenToInstamadillo",["FBLogger","I64","PolarisDirectAPI","PolarisLinkshimURI","URI","asyncToGeneratorRuntime","forwardXMAUtils","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("getSendPostToInstamadilloRecipient").__setRef("forwardXMAFromOpenToInstamadillo"),k=c("requireDeferred")("getSendProfileToInstamadilloRecipient").__setRef("forwardXMAFromOpenToInstamadillo"),l=function(a){var b=new(i||(i=c("URI")))(a);d("PolarisLinkshimURI").shouldSkipLinkShim(a)&&(b=new(i||(i=c("URI")))(b.getQueryData().u));return b.toString()};function a(a,b,c,d,e,f){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i){g=l(g);if(d("forwardXMAUtils").isFeedXma(b.defaultCtaType,g)&&e!=null){var m=(yield j.load());m=m((h||(h=d("I64"))).to_string(e),void 0,f,g,!0);yield m(a.id,a.isDisappearingModeSettingOn,i)}if(d("forwardXMAUtils").isProfileXma(b.defaultCtaType,g)){if(f==null)return;try{e=(yield d("PolarisDirectAPI").getUserProfile(f));if(e.status==="ok"){b=(m=e.data)==null||(m=m.user)==null?void 0:m.id;e=(m=e.data)==null||(m=m.user)==null?void 0:m.eimu_id;if(b!=null&&e!=null){m=(yield k.load());m=m(b,e,f,g,!0);yield m(a.id,a.isDisappearingModeSettingOn,i)}}}catch(a){c("FBLogger")("igd_web").mustfix("forwardXMAFromOpenToInstamadillo: failed to call getUserProfile Django API",String(a));return}}});return m.apply(this,arguments)}g["default"]=a}),98);
__d("forwardXMAOpenToOpen",["I64","LSFactory","LSIntEnum","LSOptimisticSendMessageForwardStoredProcedure","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardXMAOpenToOpen");function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var k=(yield j.load());k=(yield k());k=(yield k.runInTransaction(function(j){return c("LSOptimisticSendMessageForwardStoredProcedure")(c("LSFactory")(j),{forwardedMsgId:a.messageId,forwardedMsgThreadKey:a.threadKey,forwardedMsgTimestampMs:a.timestampMs,senderId:f,source:g,threadKey:(h||(h=d("I64"))).of_string(b),threadType:(i||(i=d("LSIntEnum"))).ofNumber(e)})},"readwrite"));k=k[0];return k});return k.apply(this,arguments)}g["default"]=a}),98);
__d("MWChatThreadId",["FBLogger","I64","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){switch(a.NAME){case"Group":case"User":case"Page":case"UserSecret":return a.VAL}}function b(a){switch(a.NAME){case"Group":return"g."+a.VAL;case"Page":return"p."+a.VAL;case"User":return"u."+a.VAL;case"UserSecret":throw c("FBLogger")("messenger_web").mustfixThrow("MWChatThreadIdType Not supported")}}function e(a){switch(a.targetType){case"GROUP":return{NAME:"Group",VAL:a.targetID};case"PAGE":return{NAME:"Page",VAL:a.targetID};case"USER":return{NAME:"User",VAL:a.targetID};default:throw c("FBLogger")("messenger_web").mustfixThrow("Invalid id")}}function f(a){return a.NAME==="User"}function j(a){return a.NAME==="UserSecret"}function k(a){if(a==null)return;a=a.split(":");if(a.length!==2)return;var b=a[0];a=a[1];switch(b){case"thread":return{NAME:"Group",VAL:a};case"user":return{NAME:"User",VAL:a};default:return}}function l(a){a=a.NAME;if(a==="Group")return(h||(h=d("LSIntEnum"))).ofNumber(2);return a==="User"||a==="Page"?(h||(h=d("LSIntEnum"))).ofNumber(1):(h||(h=d("LSIntEnum"))).ofNumber(7)}function m(a){return(i||(i=d("I64"))).of_string(a.VAL)}g.getFBID=a;g.serializeFuture=b;g.fromJs=e;g.isUser=f;g.isSecret=j;g.deserializeFromLegacyThreadId=k;g.getMessagingThreadType=l;g.toThreadKey=m}),98);
__d("useGetForwardSource",["LSIntEnum","LSMessagingThreadAttributionType","MWLSThreadDisplayContext"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();if(a!=null)if(a==="Inbox")return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_FORWARD);else if(a==="ChatTab")return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_CHAT_FORWARD);else return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW);else return(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW)}g["default"]=a}),98);
__d("WorkChatMessageType",[],(function(a,b,c,d,e,f){"use strict";a="text";b="gif";c="sticker";d="audio";e="file";f.text=a;f.gif=b;f.sticker=c;f.audio=d;f.file=e}),66);
__d("useMWLSSendStickerMessage",["I64","Int64Hooks","LSFactory","LSIntEnum","LSMailboxType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSOptimisticSendMessageV2StoredProcedure","LSShape","LSThreadAttributionTypeUtil","MWPActor.react","MessagePowerUp","WorkChatMessageType","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b,e){var g=(j||(j=c("useReStore")))(),k=d("MWPActor.react").useActor();return d("Int64Hooks").useCallbackInt64(function(j,l,m){c("promiseDone")(g.runInTransaction(function(e){var f=d("LSThreadAttributionTypeUtil").getSourceAndResetAttribution(j,a!=null?a:"unknown");return c("LSOptimisticSendMessageV2StoredProcedure")(c("LSFactory")(e),{extraSendMessageParams:d("LSShape").ofRecord({calculate_denormalizations:!0,initiating_source:b,mark_read:!0,optimistic_attachment_preview:d("LSShape").ofRecord({playable_url:void 0,playable_url_expiration_timestamp_ms:void 0,playable_url_fallback:void 0,playable_url_mime_type:void 0,preview_height:(h||(h=d("I64"))).zero,preview_url:m,preview_url_expiration_timestamp_ms:void 0,preview_url_fallback:void 0,preview_url_mime_type:void 0,preview_width:h.zero}),power_up_style:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagePowerUp").NONE),reply_source_id:void 0,reply_source_type:i.ofNumber(c("LSMessageReplySourceType").MESSAGE),reply_source_type_v2:i.ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE),snippet_has_emoji:!1,source:f,sticker_id:h.of_string(l)}),mailboxType:i.ofNumber(c("LSMailboxType").MESSENGER),senderId:k,threadKey:j,threadType:i.ofNumber(1)})},"readwrite",void 0,void 0,f.id+":49").then(function(a){e==null||e(d("WorkChatMessageType").sticker,1,a[0])}))},[g,k,b,a,e])}g["default"]=a}),98);
__d("MWLSForwardMessage",["I64","Int64Hooks","LSFactory","LSMediaUrlAttachment","LSOptimisticSendAttachmentForwardStoredProcedure","LSOptimisticSendMessageForwardStoredProcedure","MWChatThreadId","MWPActor.react","ODS","Promise","ReQL","promiseDone","useGetForwardSource","useLSMessagingInitiatingSource","useLSMessagingSource","useMWLSSendStickerMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(){var a=(k||(k=c("useReStore")))(),e=d("MWPActor.react").useActor(),g=c("useLSMessagingInitiatingSource")(),l=c("useGetForwardSource")(),m=c("useLSMessagingSource")(),n=c("useMWLSSendStickerMessage")(m,g);return d("Int64Hooks").useCallbackInt64(function(k,m,o){if(o.type!=="sent")return;o=o.value;var p=o.timestamp,q=o.messageId,r=o.threadId;(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","send");var s=function(){return a.runInTransaction(function(a){return c("LSOptimisticSendMessageForwardStoredProcedure")(c("LSFactory")(a),{forwardedMsgId:q,forwardedMsgThreadKey:r,forwardedMsgTimestampMs:p,initiatingSource:g,senderId:e,source:l,threadKey:k,threadType:m})},"readwrite",void 0,void 0,f.id+":62").then(function(){})};c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.messages).getKeyRange(r,p,q)).then(function(c){if(c==null)return s();var e=c.stickerId;if(e!=null)return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(r,q)).then(function(a){a=a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0;n(k,(j||(j=d("I64"))).to_string(e),a);return(h||(h=b("Promise"))).resolve()});else return s()}),function(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","success")},function(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","failure")});return},[a,e,g,l,n])}function e(){var a=(k||(k=c("useReStore")))(),b=d("MWPActor.react").useActor(),e=c("useLSMessagingInitiatingSource")(),g=c("useGetForwardSource")();return d("Int64Hooks").useMemoInt64(function(){return function(h,k,l){(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","send");var m=d("MWChatThreadId").getMessagingThreadType(h),n=d("MWChatThreadId").toThreadKey(h);c("promiseDone")(a.runInTransaction(function(a){return c("LSOptimisticSendAttachmentForwardStoredProcedure")(c("LSFactory")(a),{forwardedAttachmentFbid:(j||(j=d("I64"))).of_string(k),initiatingSource:e,senderId:b,source:g,threadKey:n,threadType:m})},"readwrite",void 0,void 0,f.id+":140"),function(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","success")},function(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","failure")})}},[a,b,e,g])}g.useForwardMessage=a;g.useForwardAttachment=e}),98);
__d("useMWV2ForwardMessage",["$InternalEnum","CometRelay","FBLogger","I64","Int64Hooks","LSIntEnum","LSMessagingThreadTypeUtil","MAWDbMsg","MAWExternalId","MAWThreadId","MAWVault","MAWVerifyThreadCutover","MWChatMessageId","MWChatThreadId","MWLSForwardMessage","MWPActor.react","MWSharedMsgLogUtils","MWSharedS2SBaseAnnotations","MWUnvaultedText","Promise","ReQL","ReQLSuspense","WAResultOrError","asyncToGeneratorRuntime","cr:19816","cr:19893","cr:19894","cr:9759","promiseDone","react","sendToSentQPLLogger","useGetForwardSource","useIsSecureMessage","useLSMessagingSource","useReStore","useStringWithSubstitutions"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=(k||d("react")).useMemo;function n(a,b,c){var e;return(e=d("ReQL")).firstAsync(e.mergeJoin(e.fromTableAscending(a.tables.participants).getKeyRange(b),e.fromTableAscending(a.tables.contacts)).filter(function(a){a[0];a=a[1];return!(l||(l=d("I64"))).equal(a.id,c)}))}function o(a,b,c){var e=b.messageId,g=b.threadKey;b=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(g,e)},[a,e,g],f.id+":89");var h=d("ReQLSuspense").useFirst(function(){return c!=null?d("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(g,e,c):d("ReQL").empty()},[c,a,e,g],f.id+":98"),i=b.length>0?b[0]:void 0;if(c!=null){h=h!=null?h:i;return h!=null?[h]:[]}return b}function p(){var a=(i||(i=c("useReStore")))();return d("Int64Hooks").useCallbackInt64(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,f,g,i,j,k,l,m,o){var p=d("MWChatThreadId").toThreadKey(j),r=d("MWChatThreadId").getMessagingThreadType(j);j=(yield d("MAWVerifyThreadCutover").verifyThreadCutover((h||(h=b("Promise"))).resolve(a),p));var s=(yield h.all([d("MAWThreadId").isSecureThreadKey(a.tables,p),d("MAWThreadId").getThread(a.tables,p),n(a,p,g)])),t=s[0],u=s[1];s=s[2];t=t||j;try{if(b("cr:19893")!=null&&!t){d("sendToSentQPLLogger").addSendToSentAnnotations(k,{string:{forward_type:q.SecureToOpen}});m!=null?yield (h||(h=b("Promise"))).allSettled([m.messagesAndAttachments.map(function(c){return b("cr:19893").forwardMessage(a,p,r,c.message,i,(c=c.attachment)!=null?c:void 0,g,l)})]):yield b("cr:19893").forwardMessage(a,p,r,e,i,f[0],g,l,o);d("sendToSentQPLLogger").markSendToSentSuccess(k);return[d("WAResultOrError").makeResult({description:"open message",messageType:"fixMe"})]}j=d("MAWDbMsg").toMsgId(e.messageId);if(j==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Message does not have an id");if(b("cr:19816")!=null){d("sendToSentQPLLogger").addSendToSentAnnotations(k,{string:{forward_type:q.SecureToSecure}});if(m!=null){t=m.messagesAndAttachments.map(function(a){return d("MAWDbMsg").toMsgId(a.message.messageId)}).filter(Boolean);f=(yield b("cr:19816").forwardMessageBatch(a,p,t,l,k))}else f=(yield b("cr:19816").forwardMessage(a,p,j,l,k,o!=null?d("MAWVault").vault(o):void 0).then(function(a){return[a]}));b("cr:9759")!=null&&u!=null&&(yield b("cr:9759")(a,u,s,d("LSMessagingThreadTypeUtil").isOneToOne(u.threadType)));return f!=null?f:[d("WAResultOrError").makeResult({description:"removal pending rollout of MAWMessageSendReporterV2",messageType:"fixMe"})]}throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We won't reach to this step, if you are in QE, you should use secure forward")}catch(a){d("sendToSentQPLLogger").markSendToSentFail(k,"failed_forwarding_message",a);c("FBLogger")("messenger_web").catching(a).mustfix("MW Fail forwarding a message");throw a}});return function(a,b,c,d,f,g,h,i,j){return e.apply(this,arguments)}}(),[a])}var q=b("$InternalEnum")({SecureToOpen:"secure_to_open",OpenToOpen:"open_to_open",SecureToSecure:"secure_to_secure",OpenToSecure:"open_to_secure"});function a(a,e,f,g){var k=(i||(i=c("useReStore")))(),r=o(k,a,f),s=c("useIsSecureMessage")(k,a,{fallbackThreadType:e}),t=d("MWPActor.react").useActor(),u=!(l||(l=d("I64"))).equal(t,a.senderId),v=d("MWLSForwardMessage").useForwardMessage(),w=d("MWLSForwardMessage").useForwardAttachment(),x=c("useGetForwardSource")(),y=d("MWChatMessageId").makeSent(l.to_string(a.threadKey),a.messageId,l.to_string(a.timestampMs)),z=d("CometRelay").useRelayEnvironment(),A=p(),B=d("MWSharedMsgLogUtils").getMessageTypeFromDisplayedContentType(a.displayedContentTypes);e=c("useLSMessagingSource")();var C=m(function(){var b;return new Set((b=(b=a.mentionIds)==null||b.split==null?void 0:b.split(","))!=null?b:[])},[a.mentionIds]),D=C.size>0,E=d("MWUnvaultedText").useMWUnvaultedText(!1,a.text);C=(C=d("useStringWithSubstitutions").useStringWithMentionSubstitutionsAndUpdatedRanges(s?E:null,[],C,a.threadKey))!=null?C:{textWithSubstitutions:E};var F=C.textWithSubstitutions,G=d("Int64Hooks").useCallbackInt64(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=d("MWChatThreadId").toThreadKey(b);c=(yield d("MAWThreadId").getThread(k.tables,c));var e=function(c){return A(a,r,t,u,b,c,x,g,D?F:void 0)};c=d("sendToSentQPLLogger").markSendToSentStartWithAnnotation(c,{isForward:!0,mediaGroupInfo:g},(j||(j=d("LSIntEnum"))).unwrapIntEnum(x),{string:{attachment_type:"forward",message_type:B}});yield e(c)});return function(a){return c.apply(this,arguments)}}(),[k,t,e,g,x,A,a,r,u,B,F,D]),H=d("Int64Hooks").useCallbackInt64(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var g=d("MWChatThreadId").toThreadKey(e),i=d("MWChatThreadId").getMessagingThreadType(e),l=(yield (h||(h=b("Promise"))).all([d("MAWThreadId").isSecureThreadKey(k.tables,g),d("MAWThreadId").getThread(k.tables,g),n(k,g,t),d("MAWVerifyThreadCutover").verifyThreadCutover(h.resolve(k),g),d("MAWThreadId").getThread(k.tables,g)])),m=l[0],o=l[1],p=l[2],s=l[3],A=l[4];l=m||s;var C=function(a){var b=d("sendToSentQPLLogger").markSendToSentStart();if(A!=null){var e=d("MWSharedS2SBaseAnnotations").getMessageTypeParams({isForward:!0,threadType:A.threadType});c("promiseDone")(d("MWSharedMsgLogUtils").getSendToSentAnnotations(A,e,(j||(j=d("LSIntEnum"))).unwrapIntEnum(x),void 0,a),function(a){a.string=babelHelpers["extends"]({},a.string,{attachment_type:"forward",message_type:B}),d("sendToSentQPLLogger").addSendToSentAnnotations(b,a)})}d("sendToSentQPLLogger").addSendToSentAnnotations(b,{string:{forward_type:q.OpenToSecure,message_type:B}});return b};if(b("cr:19894")!=null&&l){var D=function(c,d){return function(e){return b("cr:19894").forwardMessage(z,k,g,a,u,d,x,e!=null?e:void 0,c).then(function(a){return[a]})}};if(r.length===0){m=d("MAWExternalId").generateExternalId();s=C(m);yield D(m,void 0)(s);d("sendToSentQPLLogger").markSendToSentSuccess(s)}else yield (h||(h=b("Promise"))).all(r.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("MAWExternalId").generateExternalId(),e=C(b);try{yield D(b,a)(e),d("sendToSentQPLLogger").markSendToSentSuccess(e)}catch(a){d("sendToSentQPLLogger").markSendToSentFail(e,"failed_forwarding_message",a);c("FBLogger")("messenger_web").catching(a).mustfix("MW Fail forwarding a message");throw a}});return function(b){return a.apply(this,arguments)}}()));b("cr:9759")!=null&&o!=null&&b("cr:9759")(k,o,p,d("LSMessagingThreadTypeUtil").isOneToOne(o.threadType))}else if(!l){m=C();try{d("sendToSentQPLLogger").addSendToSentAnnotations(m,{string:{forward_type:q.OpenToOpen,message_type:B}});f==null?v(g,i,y):w(e,f);d("sendToSentQPLLogger").markSendToSentSuccess(m);return}catch(a){d("sendToSentQPLLogger").markSendToSentFail(m,"failed_forwarding_message",a);c("FBLogger")("messenger_web").catching(a).mustfix("MW Fail forwarding a message");throw a}}});return function(a){return e.apply(this,arguments)}}(),[k,t,x,f,z,a,u,g,e,r,v,y,w,B]);return d("Int64Hooks").useMemoInt64(function(){return s?G:H},[s,G,H])}g.ForwardType=q;g.useMWV2ForwardMessage=a}),98);
__d("forwardXMA",["I64","IGDInstamadilloUtils","asyncToGeneratorRuntime","forwardText","forwardXMAFromInstamadillo","forwardXMAFromOpenToInstamadillo","forwardXMAOpenToOpen","forwardXMAUtils","requireDeferred","sendToSentQPLLogger","useMWV2ForwardMessage"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardXMA");function a(a,b,c,d,e,f,g,h){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,j,k,l){var m,n=b.defaultCtaId;if(n==null)return;var o=(yield i.load());o=(yield o());n=(yield o.tables.attachment_ctas.get(n));m=(m=b.headerTitle)!=null?m:b.titleText;var p=n==null?void 0:n.actionUrl,q=n==null?void 0:n.targetId;if(p==null)return;o=(yield o.tables.threads.get((h||(h=d("I64"))).of_string(k.id)));o=d("forwardXMAUtils").shouldForwardXMAViaTTLC(o,a,b,n);n=k.isInstamadilloCutover||k.isDisappearingModeSettingOn||o;var r=d("IGDInstamadilloUtils").isInstamadilloMessage(a)?n?d("useMWV2ForwardMessage").ForwardType.SecureToSecure:d("useMWV2ForwardMessage").ForwardType.SecureToOpen:n?d("useMWV2ForwardMessage").ForwardType.OpenToSecure:d("useMWV2ForwardMessage").ForwardType.OpenToOpen;d("sendToSentQPLLogger").addSendToSentAnnotations(l,{bool:{use_instamadillo_transport:n,use_open_eb:o}});switch(r){case d("useMWV2ForwardMessage").ForwardType.OpenToSecure:return c("forwardXMAFromOpenToInstamadillo")(k,b,q,m,p,o);case d("useMWV2ForwardMessage").ForwardType.SecureToSecure:return c("forwardXMAFromInstamadillo")(k,a.xmaReceiverFetchParams,m,p);case d("useMWV2ForwardMessage").ForwardType.SecureToOpen:return c("forwardText")(babelHelpers["extends"]({},a,{text:p}),e,f,g,j);case d("useMWV2ForwardMessage").ForwardType.OpenToOpen:return c("forwardXMAOpenToOpen")(a,e,f,g,j)}});return j.apply(this,arguments)}g["default"]=a}),98);
__d("useIGDForwardMessage",["FBLogger","I64","IGDThreadTTLCUtils","LSBitFlag","LSIntEnum","MWPActor.react","MWSharedS2SBaseAnnotations","MercuryLocalIDs","MessagingAttachmentType","PolarisDirectAPI","PolarisDirectConstants","ReQL","asyncToGeneratorRuntime","forwardAttachment","forwardAttachmentCollectionToOpen","forwardAttachmentToOpen","forwardText","forwardXMA","qex","react-compiler-runtime","sendIGDOptimisticRichContentMessage","sendToSentQPLLogger","useAsyncReStore","useGetForwardSource"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("qex")._("41")===!0;function k(a,b,c,d,e,f){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,k){var l=e.candidate;e=e.type;var m=l.id;e=e==="thread"?2:1;var n=(yield a.tables.threads.get((h||(h=d("I64"))).of_string(m))),o=l.isInstamadilloCutover||l.isDisappearingModeSettingOn;if(d("LSBitFlag").has((i||(i=d("LSIntEnum"))).ofNumber(1),b.displayedContentTypes)){var p=d("IGDThreadTTLCUtils").isInstamadilloTTLCTextEnabled(n),q=o||p;d("sendToSentQPLLogger").addSendToSentAnnotations(k,{bool:{use_instamadillo_transport:q,use_open_eb:p}});return c("forwardText")(b,l.id,e,f,g,{useInstamadilloTransport:q,useOpenEb:p})}q=d("ReQL").fromTableDescending(a.tables.attachments).getKeyRange(b.threadKey,b.messageId);p=(yield d("ReQL").toArrayAsync(q));if(p.length>1&&j)return c("forwardAttachmentCollectionToOpen")(b,m,e,f,g);else if(p.length>0){q=p[0];p=(i||(i=d("LSIntEnum"))).unwrapIntEnum(q.attachmentType);if(p===c("MessagingAttachmentType").XMA)if(q.stickerType==="cutout_sticker"){var r=(yield a.tables.ig_thread_info.get((h||(h=d("I64"))).of_string(m)));r=r==null?void 0:r.igThreadId;var s=b.threadKey;s=(yield a.tables.ig_thread_info.get(s));s=s==null?void 0:s.igThreadId;if(r==null||s==null)throw c("FBLogger")("igd_web").mustfixThrow("Failed to forward the cutout sticker");var t=d("MercuryLocalIDs").generateOfflineThreadingID(),u=h.of_float(Date.now()),v=1024+8;yield c("sendIGDOptimisticRichContentMessage")(a,(a=q.previewHeight)!=null?a:(h||(h=d("I64"))).zero,(a=q.previewWidth)!=null?a:(h||(h=d("I64"))).zero,t,h.of_int32(v),f,u,h.of_string(m),c("MessagingAttachmentType").XMA,(a=q.previewUrl)!=null?a:"","cutout_sticker");return d("PolarisDirectAPI").broadcastForward(r,d("PolarisDirectConstants").ThreadItemType.GENERIC_XMA,b.messageId,s,t)}else return c("forwardXMA")(b,q,l.id,e,f,g,l,k);else if(p===c("MessagingAttachmentType").ANIMATED_IMAGE)return c("forwardAttachmentToOpen")(q,l.id,e,f,g);else{v=!1;p===c("MessagingAttachmentType").IMAGE?v=d("IGDThreadTTLCUtils").isInstamadilloTTLCImageEnabled(n):p===c("MessagingAttachmentType").VIDEO?v=d("IGDThreadTTLCUtils").isInstamadilloTTLCVideoEnabled(n):p===c("MessagingAttachmentType").AUDIO&&(v=d("IGDThreadTTLCUtils").isInstamadilloTTLCAudioEnabled(n));u=o||v;d("sendToSentQPLLogger").addSendToSentAnnotations(k,{bool:{use_instamadillo_transport:u,use_open_eb:v}});return c("forwardAttachment")(q,l.id,e,f,g,{useInstamadilloTransport:u,useOpenEb:v})}}});return l.apply(this,arguments)}function a(a){var e=d("react-compiler-runtime").c(5),f=c("useAsyncReStore")(),g=c("useGetForwardSource")(),h=d("MWPActor.react").useActor(),i;e[0]!==f||e[1]!==a||e[2]!==h||e[3]!==g?(i=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e=d("sendToSentQPLLogger").markSendToSentStart(),i=(yield m(yield f,a));d("sendToSentQPLLogger").addSendToSentAnnotations(e,i);try{yield k(yield f,a,b,h,g,e),d("sendToSentQPLLogger").markSendToSentSuccess(e)}catch(a){i=a;d("sendToSentQPLLogger").markSendToSentFail(e,"message_send_fail",i);c("FBLogger")("igd_web").catching(i).mustfix("IGD failure forwarding a message")}});return function(a){return e.apply(this,arguments)}}(),e[0]=f,e[1]=a,e[2]=h,e[3]=g,e[4]=i):i=e[4];return i}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.tables.attachments).getKeyRange(b.threadKey,b.messageId)));a=e!=null?Object.keys(c("MessagingAttachmentType")).find(function(a){return c("MessagingAttachmentType")[a]===(i||(i=d("LSIntEnum"))).unwrapIntEnum(e.attachmentType)}):null;b=(h||(h=d("I64"))).equal(b.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(1))?d("MWSharedS2SBaseAnnotations").MsgType.Text:d("MWSharedS2SBaseAnnotations").MsgType.NonText;return{bool:{is_forward_message:!0},string:{attachment_type:a,message_type:b}}});return n.apply(this,arguments)}g["default"]=a}),98);
__d("useIGDMessageForwardMenuItem.react",["fbt","I64","IGDContactSearchDialogType.flow","IGDInstamadilloUtils","IGDMessageContextMenuItem.react","IGDSDialogPlaceholder.react","IGDSMessagesOutlineIcon.react","IGDThreadListNewMessageLoggingDataContext","JSResourceForInteraction","LSBitFlag","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","MWPActor.react","MWV2MessageRowIsRowFocusedContext.react","MessagingAttachmentType","MessengerWebUXLogger","ReQL","ReQLSuspense","asyncToGeneratorRuntime","getInstamadilloLoggingExtraData","gkx","qex","react","react-compiler-runtime","useIGDForwardMessage","useIGDMessageAttachment","useIGDSLazyDialog","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||d("react"),n=function(){return c("qex")._("121")===!0},o=c("qex")._("41")===!0,p=c("gkx")("16543");function a(a,e){var g=d("react-compiler-runtime").c(22),l=(i||(i=c("useReStore")))(),t=d("MWPActor.react").useActor(),u=a.displayedContentTypes,v=a.senderId,w=a.threadKey,x=c("useIsReadOnlyFeatureLimited")(),y=c("useIsThreadBlocked")(),z=d("MWLSThread").useThreadExn(a.threadKey),A=z.threadType,B;g[0]!==l.tables.contacts||g[1]!==v?(B=function(){return d("ReQL").fromTableAscending(l.tables.contacts).getKeyRange(v)},g[0]=l.tables.contacts,g[1]=v,g[2]=B):B=g[2];var C;g[3]!==l||g[4]!==v?(C=[l,v],g[3]=l,g[4]=v,g[5]=C):C=g[5];B=d("ReQLSuspense").useFirst(B,C,f.id+":74");C=B!=null&&d("LSContactBitOffset").has(66,B);var D=d("LSThreadBitOffset").has(103,z),E=d("LSMessagingThreadTypeUtil").isIGDMessageRequest(z),F=(j||(j=d("I64"))).equal(a.displayedContentTypes,(k||(k=d("LSIntEnum"))).ofNumber(256));t=j.equal(v,t);t=!t&&d("LSMessagingThreadTypeUtil").isOneToOne(A)&&B!=null?!(j||(j=d("I64"))).equal(B.blockedByViewerStatus,(k||(k=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED)):!1;B=c("useIGDMessageAttachment")(l,a,w);w=B.attachment;var G=B.hasMultipleAttachments;B=B.isVideoStack;var H=w!=null&&((j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))||(j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))),I=w!=null&&(j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)),J=w!=null&&(j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER)),K=w!=null&&(j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?w.isSharable:!0;w=w!=null&&(j||(j=d("I64"))).equal(w.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))&&w.stickerType==="ai_generated_sticker";u=(j||(j=d("I64"))).equal(u,d("LSBitFlag").empty)&&!H;var L=c("useIGDForwardMessage")(a),M=c("MessengerWebUXLogger").useInteractionLogger(),N=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),O=d("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext(),P=O.setIsDialogOpened;g[6]===Symbol["for"]("react.memo_cache_sentinel")?(O=c("JSResourceForInteraction")("IGDAWOminipickerDialog.react").__setRef("useIGDMessageForwardMenuItem.react"),g[6]=O):O=g[6];O=c("useIGDSLazyDialog")(O,s);var Q=O[0];O=d("IGDInstamadilloUtils").isInstamadilloMessage(a)&&a.ephemeralDurationInSec!=null&&(j||(j=d("I64"))).gt(a.ephemeralDurationInSec,(j||(j=d("I64"))).zero);y=!y&&!C&&!E&&!x&&!a.isUnsent&&!u&&(d("LSMessagingThreadTypeUtil").isArmadilloSecure(A)?n():!0)&&D&&K&&!t&&!F&&!H&&!I&&!O&&(!G||o)&&(!B||p)&&!J&&!w;if(!y)return null;g[7]!==L?(C=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){Array.from(a.values()).map(function(a){return L(a)})});return function(b){return a.apply(this,arguments)}}(),g[7]=L,g[8]=C):C=g[8];var R=C;g[9]!==N||g[10]!==G||g[11]!==M||g[12]!==e||g[13]!==R||g[14]!==P||g[15]!==Q||g[16]!==z?(E=function(){M==null||M({eventName:"message_forward",extraData:c("getInstamadilloLoggingExtraData")(z),flowInstanceId:N}),G&&o&&(M==null||M({eventName:"media_collection_message_forward"})),Q({includeGroup:!0,loggingEventName:"forward_thread_attempt",maxRecipients:5,onSubmit:R,searchType:d("IGDContactSearchDialogType.flow").IGDContactSearchDialogType.FORWARD_MESSAGE,submitButtonLabel:h._(/*BTDS*/"\u9001\u4fe1").toString(),titleLabel:h._(/*BTDS*/"\u8ee2\u9001").toString()},function(){e(),P(r)}),P(q)},g[9]=N,g[10]=G,g[11]=M,g[12]=e,g[13]=R,g[14]=P,g[15]=Q,g[16]=z,g[17]=E):E=g[17];x=E;g[18]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"\u8ee2\u9001"),g[18]=a):a=g[18];u=a;g[19]===Symbol["for"]("react.memo_cache_sentinel")?(A=m.jsx(c("IGDSMessagesOutlineIcon.react"),{alt:u,size:18}),g[19]=A):A=g[19];g[20]!==x?(D=m.jsx(c("IGDMessageContextMenuItem.react"),{icon:A,label:u,onClick:x,testid:void 0}),g[20]=x,g[21]=D):D=g[21];return D}function q(){return!0}function r(){return!1}function s(a){return m.jsx(c("IGDSDialogPlaceholder.react"),{fixedHeight:!0,onClose:a,size:"large"})}s.displayName=s.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useIGDMessageInspectMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSDialogPlaceholder.react","IGDSSearchPanoOutlineIcon.react","JSResourceForInteraction","MWV2MessageRowIsRowFocusedContext.react","gkx","react","react-compiler-runtime","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));i.useCallback;var k={dialog:{height:"xrqonrr",width:"x1m7g9aj",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(9),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._(/*BTDS*/"[Internal] Inspect"),b[0]=e):e=b[0];e=e;var f=d("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext(),g=f.setIsDialogOpened;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(f=c("JSResourceForInteraction")("IGDMessageInspectMessageDialog.react").__setRef("useIGDMessageInspectMenuItem.react"),b[1]=f):f=b[1];f=c("useIGDSLazyDialog")(f,n);var i=f[0];b[2]!==a||b[3]!==g||b[4]!==i?(f=function(){i({message:a},function(){g(m)}),g(l)},b[2]=a,b[3]=g,b[4]=i,b[5]=f):f=b[5];f=f;var k=c("gkx")("24015");if(!k)return null;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(k=j.jsx(c("IGDSSearchPanoOutlineIcon.react"),{alt:e,size:18}),b[6]=k):k=b[6];b[7]!==f?(k=j.jsx(c("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:k,label:e,onClick:f,testid:void 0}),b[7]=f,b[8]=k):k=b[8];return k}function l(){return!0}function m(){return!1}function n(a){return j.jsx(c("IGDSDialogPlaceholder.react"),{innerContentXStyle:k.dialog,onClose:a})}n.displayName=n.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useIGDMessageNegativeFeedbackMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSDialogPlaceholder.react","IGDSThumbDownPanoOutline24Icon.react","JSResourceForInteraction","emptyFunction","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDIsGenAiReelsPlugin","useIGDSLazyDialog","useIGDSToaster","useMWV2SubmitFeedbackAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));i.useCallback;function a(a){var b=d("react-compiler-runtime").c(11),e=c("useIGDSToaster")(),f;b[0]!==e?(f=function(){e.add({message:h._(/*BTDS*/"\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f"),target:"bottom-left"})},b[0]=e,b[1]=f):f=b[1];f=f;var g=c("useMWV2SubmitFeedbackAction")(a.botResponseId,f);b[2]===Symbol["for"]("react.memo_cache_sentinel")?(f=c("JSResourceForInteraction")("MWV2SubmitNegativeFeedbackDialog.react").__setRef("useIGDMessageNegativeFeedbackMenuItem.react"),b[2]=f):f=b[2];f=c("useIGDSLazyDialog")(f,k);var i=f[0];b[3]!==a||b[4]!==g||b[5]!==i?(f=function(){i({message:a,onSubmit:g},c("emptyFunction"))},b[3]=a,b[4]=g,b[5]=i,b[6]=f):f=b[6];f=f;var l=c("useGenAIFeedbackSubmissionStatus")(a.botResponseId),m=c("useIGDIsGenAiReelsPlugin")(a);if(l==null||m)return null;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(l=h._(/*BTDS*/"\u826f\u304f\u306a\u3044\u56de\u7b54"),b[7]=l):l=b[7];m=l;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(l=j.jsx(c("IGDSThumbDownPanoOutline24Icon.react"),{alt:m,size:18}),b[8]=l):l=b[8];b[9]!==f?(l=j.jsx(c("IGDMessageContextMenuItem.react"),{icon:l,label:m,onClick:f}),b[9]=f,b[10]=l):l=b[10];return l}function k(a){return j.jsx(c("IGDSDialogPlaceholder.react"),{fixedHeight:!0,onClose:a,size:"large"})}k.displayName=k.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useIGDMessagePositiveFeedbackMenuItem.react",["fbt","BotFeedbackKind","IGDMessageContextMenuItem.react","IGDSThumbUpPanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","MessengerWebUXLogger","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDIsGenAiReelsPlugin","useIGDSToaster","useMWV2SubmitFeedbackAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;b.useMemo;function a(a,b){var e,f=d("react-compiler-runtime").c(16),g=c("useIGDSToaster")(),i;f[0]!==g?(i=function(){g.add({message:h._(/*BTDS*/"\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u304c\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f"),target:"bottom-left"})},f[0]=g,f[1]=i):i=f[1];i=i;var k=c("useMWV2SubmitFeedbackAction")(a.botResponseId,i);i=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext();e=(e=a.botResponseId)!=null?e:"";var l;f[2]!==e?(l={botResponseId:e},f[2]=e,f[3]=l):l=f[3];f[4]!==i||f[5]!==l?(e={extraData:l,flowInstanceId:i},f[4]=i,f[5]=l,f[6]=e):e=f[6];i=e;var m=i,n=c("MessengerWebUXLogger").useInteractionLogger();f[7]!==m||f[8]!==n||f[9]!==b||f[10]!==k?(l=function(){k(c("BotFeedbackKind").BOT_FEEDBACK_POSITIVE),n==null||n(babelHelpers["extends"]({eventName:"submit_positive_feedback"},m)),b()},f[7]=m,f[8]=n,f[9]=b,f[10]=k,f[11]=l):l=f[11];e=l;i=c("useGenAIFeedbackSubmissionStatus")(a.botResponseId);l=c("useIGDIsGenAiReelsPlugin")(a);if(i==null||l)return null;f[12]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"\u826f\u3044\u56de\u7b54"),f[12]=a):a=f[12];i=a;f[13]===Symbol["for"]("react.memo_cache_sentinel")?(l=j.jsx(c("IGDSThumbUpPanoOutline24Icon.react"),{alt:i,size:18}),f[13]=l):l=f[13];f[14]!==e?(a=j.jsx(c("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:l,label:i,onClick:e}),f[14]=e,f[15]=a):a=f[15];return a}g["default"]=a}),226);
__d("useIGDMessageReaction.react",["fbt","EmojiFormat.bs","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","MWLSThread","MWV2MessageReactionHooks","MessengerWebUXLogger","UnicodeUtils","asyncToGeneratorRuntime","emptyFunction","getInstamadilloLoggingExtraData","promiseDone","react","react-compiler-runtime","useAsyncReStore","useIGDGlobalReactMessage"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;(i||d("react")).useCallback;function a(a,e){var f,g=d("react-compiler-runtime").c(20),i=(f=d("MWV2MessageReactionHooks").MWV2MessageReactionHooks.useSelectedReaction(a.messageId,a.threadKey))==null?void 0:f.reaction,k=c("useIGDGlobalReactMessage")(a,"reaction_tray");g[0]!==e||g[1]!==i||g[2]!==k?(f=function(a){var b=d("EmojiFormat.bs").codeArrayToUnicode(a);if(i!=null){var f=(j||(j=d("UnicodeUtils"))).getCodePoints(i);b===i&&(b=void 0);f[0]===10084&&a[0]===10084&&(b=void 0)}c("promiseDone")(k(b,"reaction"));e()},g[0]=e,g[1]=i,g[2]=k,g[3]=f):f=g[3];f=f;var l;g[4]!==f?(l={closeAfterSelect:!0,onClose:c("emptyFunction"),onSelect:f,showPopoverArrow:!1},g[4]=f,g[5]=l):l=g[5];f=l;g[6]===Symbol["for"]("react.memo_cache_sentinel")?(l=h._(/*BTDS*/"\u30ea\u30a2\u30af\u30b7\u30e7\u30f3\u3059\u308b"),g[6]=l):l=g[6];l=l;var m=c("useAsyncReStore")(),n=c("MessengerWebUXLogger").useInteractionLogger(),o=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),p,q;g[7]!==m||g[8]!==o||g[9]!==n||g[10]!==a.messageId||g[11]!==a.threadKey?(p=function(e){c("promiseDone")(m.then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("MWLSThread").getThreadAsync(b,a.threadKey));b&&(n==null||n({eventName:"reaction_open_emoji_picker",extraData:babelHelpers["extends"]({},c("getInstamadilloLoggingExtraData")(b),{message_id:a.messageId}),flowInstanceId:o}))});return function(a){return e.apply(this,arguments)}}())),e()},q=[m,o,n,a.messageId,a.threadKey],g[7]=m,g[8]=o,g[9]=n,g[10]=a.messageId,g[11]=a.threadKey,g[12]=p,g[13]=q):(p=g[12],q=g[13]);p=d("Int64Hooks").useCallbackInt64(p,q);g[14]!==i?(q=i!=null?(j||(j=d("UnicodeUtils"))).getCodePoints(i):null,g[14]=i,g[15]=q):q=g[15];g[16]!==p||g[17]!==f||g[18]!==q?(l=[l,p,f,q],g[16]=p,g[17]=f,g[18]=q,g[19]=l):l=g[19];return l}g["default"]=a}),226);
__d("useIGDMessageReactionMenuItem.react",["I64","LSBitFlag","LSContactBitOffset","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","cr:8247","cr:8257","gkx","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDMessageReaction.react","useIsGenAiFeedbackEnabled","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||d("react");function a(a,e){var g=d("react-compiler-runtime").c(16),j=(h||(h=c("useReStore")))(),l=a.displayedContentTypes,m=a.senderId,n=c("useIsThreadBlocked")(),o=d("MWLSThread").useThreadExn(a.threadKey),p=d("LSMessagingThreadTypeUtil").isIGDMessageRequest(o),q=c("useIsReadOnlyFeatureLimited")(),r;g[0]!==j.tables.contacts||g[1]!==m?(r=function(){return d("ReQL").fromTableAscending(j.tables.contacts).getKeyRange(m)},g[0]=j.tables.contacts,g[1]=m,g[2]=r):r=g[2];var s;g[3]!==j||g[4]!==m?(s=[j,m],g[3]=j,g[4]=m,g[5]=s):s=g[5];r=d("ReQLSuspense").useFirst(r,s,f.id+":52");s=d("LSThreadBitOffset").has(18,o);var t=d("LSThreadBitOffset").has(139,o);o=d("LSThreadBitOffset").has(169,o);l=(i||(i=d("I64"))).equal(l,d("LSBitFlag").empty);r=r!=null&&d("LSContactBitOffset").has(66,r);var u=c("useIsGenAiFeedbackEnabled")(a.botResponseId,c("gkx")("4253")===!0),v=c("useGenAIFeedbackSubmissionStatus")(a.botResponseId);n=!n&&!r&&!p&&!q&&!a.isUnsent&&!l&&(t?o:s)&&u&&v==null;r=c("useIGDMessageReaction.react")(a,e);p=r[0];var w=r[1];q=r[2];l=r[3];if(!n)return null;g[6]!==w?(t=function(a){return w(a)},g[6]=w,g[7]=t):t=g[7];g[8]!==p||g[9]!==t?(o={align:"start",altLabel:p,label:p,onClickAction:t,useMenuItem:!0},g[8]=p,g[9]=t,g[10]=o):o=g[10];s=o;g[11]!==a.threadKey||g[12]!==q||g[13]!==l||g[14]!==s?(u=b("cr:8257")?k.jsx(b("cr:8257"),babelHelpers["extends"]({},s,{onClose:q.onClose,onSelect:q.onSelect,selectedReaction:l})):b("cr:8247")?k.jsx(b("cr:8247"),babelHelpers["extends"]({threadKey:a.threadKey},s,q)):null,g[11]=a.threadKey,g[12]=q,g[13]=l,g[14]=s,g[15]=u):u=g[15];return u}g["default"]=a}),98);
__d("useIGDMessageReplyMenuItem.react",["I64","IGDInstamadilloUtils","IGDMessageContextMenuItem.react","IGDSReplyPanoOutline24Icon.react","LSBitFlag","LSContactBitOffset","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","gkx","react","react-compiler-runtime","useGenAIFeedbackSubmissionStatus","useIGDMessageReply.react","useIsGenAiFeedbackEnabled","useIsReadOnlyFeatureLimited","useIsThreadBlocked","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||d("react");function a(a,b){var e=d("react-compiler-runtime").c(12),g=(h||(h=c("useReStore")))(),j=a.displayedContentTypes,l=a.senderId,m=c("useIsThreadBlocked")(),n=d("MWLSThread").useThreadExn(a.threadKey),o=d("LSMessagingThreadTypeUtil").isIGDMessageRequest(n),p=c("useIsReadOnlyFeatureLimited")(),q;e[0]!==g.tables.contacts||e[1]!==l?(q=function(){return d("ReQL").fromTableAscending(g.tables.contacts).getKeyRange(l)},e[0]=g.tables.contacts,e[1]=l,e[2]=q):q=e[2];var r;e[3]!==g||e[4]!==l?(r=[g,l],e[3]=g,e[4]=l,e[5]=r):r=e[5];q=d("ReQLSuspense").useFirst(q,r,f.id+":52");r=d("LSThreadBitOffset").has(42,n);b=c("useIGDMessageReply.react")(a,n,b);var s=b[0];b=b[1];var t=c("useIsGenAiFeedbackEnabled")(a.botResponseId,c("gkx")("4253")===!0),u=c("useGenAIFeedbackSubmissionStatus")(a.botResponseId);if(!r||!t)return null;r=(i||(i=d("I64"))).equal(j,d("LSBitFlag").empty);j=q!=null&&d("LSContactBitOffset").has(66,q);q=d("IGDInstamadilloUtils").isIGDDisappearingModeEnabled(n);n=!m&&!j&&!o&&!p&&!a.isUnsent&&!r&&t&&u==null&&d("IGDInstamadilloUtils").shouldRenderMessageReply(a,q);if(!n)return null;e[6]!==b?(m=k.jsx(c("IGDSReplyPanoOutline24Icon.react"),{alt:b,size:18}),e[6]=b,e[7]=m):m=e[7];e[8]!==b||e[9]!==s||e[10]!==m?(j=k.jsx(c("IGDMessageContextMenuItem.react"),{icon:m,label:b,onClick:s}),e[8]=b,e[9]=s,e[10]=m,e[11]=j):j=e[11];return j}g["default"]=a}),98);
__d("IGDMessageReportMenuItem.react",["fbt","IGDMessageContextMenuItem.react","IGDSReportPanoOutline24Icon.react","MWPActor.react","emptyFunction","promiseDone","react","requireDeferred","useIGDSLazyDialog","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react")),l=j.useCallback,m=c("requireDeferred")("MWLogMessageAction").__setRef("IGDMessageReportMenuItem.react");function a(a){var b=a.dialogProps,e=a.dialogResource,f=a.message,g=d("MWPActor.react").useActor(),j=(i||(i=c("useReStore")))();a=h._(/*BTDS*/"\u5831\u544a\u3059\u308b");e=c("useIGDSLazyDialog")(e);var n=e[0];e=l(function(){n(b,c("emptyFunction")),m.onReady(function(a){return c("promiseDone")(a.log(j,f.messageId,f.threadKey,"message_dot_menu","report",void 0,void 0,void 0,f.senderId,void 0,g))})},[g,j,b,f.messageId,f.senderId,f.threadKey,n]);return k.jsx(c("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:k.jsx(c("IGDSReportPanoOutline24Icon.react"),{alt:a,color:"ig-error-or-destructive",size:18}),label:a,labelProps:{color:"errorOrDestructive"},onClick:e,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useIGDMessageReportMenuItem.react",["I64","IGDMessageReportMenuItem.react","JSResourceForInteraction","LSContactBitOffset","LSIntEnum","LSMessagingThreadTypeUtil","MWPActor.react","ReQL","ReQLSuspense","emptyFunction","getLSMediaContactProfilePictureUrl","react","react-compiler-runtime","useMWBShouldReportThreadAsInstamadillo","usePolarisAnalyticsContext","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||d("react"),m=[(j||(j=d("LSIntEnum"))).ofNumber(1),j.ofNumber(16384),j.ofNumber(2),j.ofNumber(4),(k||(k=d("I64"))).add(j.ofNumber(1),j.ofNumber(8192)),k.add(j.ofNumber(16384),j.ofNumber(8192)),k.add(j.ofNumber(2),j.ofNumber(8192)),k.add(j.ofNumber(4),j.ofNumber(8192))];function a(a,b){var e=d("react-compiler-runtime").c(57),g=(h||(h=c("useReStore")))(),i=d("MWPActor.react").useActor(),j=a.displayedContentTypes,n=a.senderId,o;e[0]!==g.tables.contacts||e[1]!==n?(o=function(){return d("ReQL").fromTableAscending(g.tables.contacts).getKeyRange(n)},e[0]=g.tables.contacts,e[1]=n,e[2]=o):o=e[2];var p;e[3]!==g||e[4]!==n?(p=[g,n],e[3]=g,e[4]=n,e[5]=p):p=e[5];o=d("ReQLSuspense").useFirst(o,p,f.id+":65");p=o!=null&&d("LSContactBitOffset").has(18,o);o=(k||(k=d("I64"))).equal(n,i);var q;e[6]!==g.tables.contacts||e[7]!==a.senderId?(q=function(){return d("ReQL").fromTableAscending(g.tables.contacts).getKeyRange(a.senderId)},e[6]=g.tables.contacts,e[7]=a.senderId,e[8]=q):q=e[8];var r;e[9]!==g||e[10]!==a.senderId?(r=[g,a.senderId],e[9]=g,e[10]=a.senderId,e[11]=r):r=e[11];q=d("ReQLSuspense").useFirst(q,r,f.id+":77");e[12]!==g.tables.ig_thread_info||e[13]!==a.threadKey?(r=function(){return d("ReQL").fromTableAscending(g.tables.ig_thread_info).getKeyRange(a.threadKey)},e[12]=g.tables.ig_thread_info,e[13]=a.threadKey,e[14]=r):r=e[14];var s;e[15]!==g||e[16]!==a.threadKey?(s=[g,a.threadKey],e[15]=g,e[16]=a.threadKey,e[17]=s):s=e[17];r=d("ReQLSuspense").useFirst(r,s,f.id+":82");e[18]!==g.tables.threads||e[19]!==a.threadKey?(s=function(){return d("ReQL").fromTableAscending(g.tables.threads).getKeyRange(a.threadKey)},e[18]=g.tables.threads,e[19]=a.threadKey,e[20]=s):s=e[20];var t;e[21]!==g||e[22]!==a.threadKey?(t=[g,a.threadKey],e[21]=g,e[22]=a.threadKey,e[23]=t):t=e[23];s=d("ReQLSuspense").useFirst(s,t,f.id+":90");e[24]!==i||e[25]!==g.tables.mailbox_metadata?(t=function(){return d("ReQL").fromTableAscending(g.tables.mailbox_metadata).getKeyRange(i)},e[24]=i,e[25]=g.tables.mailbox_metadata,e[26]=t):t=e[26];var u;e[27]!==i||e[28]!==g?(u=[g,i],e[27]=i,e[28]=g,e[29]=u):u=e[29];t=d("ReQLSuspense").useFirst(t,u,f.id+":95");u=c("useMWBShouldReportThreadAsInstamadillo")(s);var v=c("usePolarisAnalyticsContext")()+"WWW";p=p&&!o&&m.findIndex(function(a){return(k||(k=d("I64"))).equal(j,a)})!==-1;if(!p||q==null||t==null||r==null||s==null)return null;e[30]!==b?(o=d("LSMessagingThreadTypeUtil").isGroup(b),e[30]=b,e[31]=o):o=e[31];e[32]!==q?(p=c("getLSMediaContactProfilePictureUrl")(q),e[32]=q,e[33]=p):p=e[33];e[34]!==a.senderId?(s=(k||(k=d("I64"))).to_string(a.senderId),e[34]=a.senderId,e[35]=s):s=e[35];q=(b=q.secondaryName)!=null?b:"";e[36]!==u||e[37]!==o||e[38]!==p||e[39]!==s||e[40]!==q?(b={isGroup:o,onClose:c("emptyFunction"),profilePicUrl:p,senderId:s,shouldReportAsInstamadillo:u,username:q},e[36]=u,e[37]=o,e[38]=p,e[39]=s,e[40]=q,e[41]=b):b=e[41];o=b;if(u){p=a.messageId;e[42]!==a.threadKey?(s=(k||(k=d("I64"))).to_string(a.threadKey),e[42]=a.threadKey,e[43]=s):s=e[43];e[44]!==a.messageId||e[45]!==o||e[46]!==s?(q=babelHelpers["extends"]({},o,{reportedObjectID:p,threadId:s}),e[44]=a.messageId,e[45]=o,e[46]=s,e[47]=q):q=e[47];b=q}else{u=r.igThreadId+"_"+encodeURI(btoa(a.messageId))+"_"+(k||(k=d("I64"))).to_string(t.id);e[48]!==v||e[49]!==o||e[50]!==u||e[51]!==r.igThreadId?(p=babelHelpers["extends"]({},o,{containerModule:v,reportedObjectID:u,threadId:r.igThreadId}),e[48]=v,e[49]=o,e[50]=u,e[51]=r.igThreadId,e[52]=p):p=e[52];b=p}s=b;e[53]===Symbol["for"]("react.memo_cache_sentinel")?(q=c("JSResourceForInteraction")("PolarisDirectReportingMessageModal.react").__setRef("useIGDMessageReportMenuItem.react"),e[53]=q):q=e[53];e[54]!==a||e[55]!==b?(t=l.jsx(c("IGDMessageReportMenuItem.react"),{dialogProps:s,dialogResource:q,message:a}),e[54]=a,e[55]=b,e[56]=t):t=e[56];return t}g["default"]=a}),98);
__d("useIGDMessageTimestampMenuItem.react",["I64","IGDSBox.react","IGDSContextMenuItem.react","IGDSText.react","MWEditedEyebrowLabel.react","MWPDateBreak.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react"),k={container:{paddingBottom:"x18d9i69",paddingInlineEnd:"xf159sx",paddingInlineStart:"xmzvs34",paddingTop:"xexx8yu",$$css:!0},containerWithDelimiter:{paddingBottom:"x10b6aqq",paddingInlineEnd:"xf159sx",paddingInlineStart:"xmzvs34",paddingTop:"xexx8yu",$$css:!0},editLabel:{marginTop:"xvijh9v",$$css:!0},separator:{paddingInlineEnd:"x14vy60q",paddingInlineStart:"x25sj25",$$css:!0}};function a(a,b,e){var f=d("react-compiler-runtime").c(17),g;f[0]!==a?(g=(i||(i=d("I64"))).to_float(a),f[0]=a,f[1]=g):g=f[1];f[2]!==g?(a=j.jsx(c("MWPDateBreak.react"),{renderTextWrapper:l,timestamp:g}),f[2]=g,f[3]=a):a=f[3];f[4]!==b?(g=b&&j.jsx(c("IGDSBox.react"),{xstyle:k.editLabel,children:j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",children:j.jsx(c("MWEditedEyebrowLabel.react"),{separatorStyle:k.separator})})}),f[4]=b,f[5]=g):g=f[5];f[6]!==a||f[7]!==g?(b=j.jsxs(c("IGDSBox.react"),{alignItems:"center",direction:"row",children:[a,g]}),f[6]=a,f[7]=g,f[8]=b):b=f[8];a=e?k.containerWithDelimiter:k.container;f[9]!==b||f[10]!==a?(g=j.jsx(d("IGDSContextMenuItem.react").IGDSContextMenuItem,{title:b,xstyle:a}),f[9]=b,f[10]=a,f[11]=g):g=f[11];f[12]!==e?(b=e?j.jsx("div",{className:"x1y3jaa6 x28ko6u xdj266r x1w5wx5t x1e56ztr x1qfufaz"}):null,f[12]=e,f[13]=b):b=f[13];f[14]!==g||f[15]!==b?(a=j.jsxs(c("IGDSBox.react"),{children:[g,b]}),f[14]=g,f[15]=b,f[16]=a):a=f[16];return a}function l(a){return j.jsx(c("IGDSText.react"),{color:"secondaryText",size:"footnote",weight:"semibold",children:a})}l.displayName=l.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("IGDSUndoCirclePanoOutline24Icon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4),e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M12 .5C5.659.5.5 5.66.5 12S5.659 23.5 12 23.5c6.34 0 11.5-5.16 11.5-11.5S18.34.5 12 .5Zm0 21c-5.238 0-9.5-4.262-9.5-9.5S6.762 2.5 12 2.5s9.5 4.262 9.5 9.5-4.262 9.5-9.5 9.5Z"}),f=i.jsx("path",{d:"M14.5 10H9.414l1.293-1.293a1 1 0 1 0-1.414-1.414l-3 2.999a1 1 0 0 0 0 1.414l3 3.001a.997.997 0 0 0 1.414 0 1 1 0 0 0 0-1.414L9.415 12H14.5c.827 0 1.5.674 1.5 1.501 0 .395-.157.794-.431 1.096-.227.249-.508.403-.735.403L14 14.999a1 1 0 0 0-.001 2l.833.001h.002c.796 0 1.604-.386 2.215-1.059a3.625 3.625 0 0 0 .951-2.44C18 11.571 16.43 10 14.5 10Z"}),b[0]=e,b[1]=f):(e=b[0],f=b[1]);b[2]!==a?(e=i.jsxs(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:[e,f]})),b[2]=a,b[3]=e):e=b[3];return e}b=i.memo(a);g["default"]=b}),98);
__d("useIGDMessageUnsendMenuItem.react",["fbt","I64","IGDMessageContextMenuItem.react","IGDSUndoCirclePanoOutline24Icon.react","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","JSResourceForInteraction","MWPActor.react","MWPThreadCapabilitiesContext","MWV2MessageRowIsRowFocusedContext.react","MessengerWebUXLogger","PolarisDirectLogger","getInstamadilloLoggingExtraData","react","react-compiler-runtime","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a,b){var e=d("react-compiler-runtime").c(19),f=d("MWPActor.react").useActor(),g=a.senderId;g=(j||(j=d("I64"))).equal(g,f);var i=c("MessengerWebUXLogger").useInteractionLogger(),n=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext();f=d("MWV2MessageRowIsRowFocusedContext.react").useMWV2MessageRowIsRowFocusedContext();var o=f.setIsDialogOpened;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=c("JSResourceForInteraction")("IGDMessageUnsendDialog.react").__setRef("useIGDMessageUnsendMenuItem.react"),e[0]=f):f=e[0];f=c("useIGDSLazyDialog")(f);var p=f[0];e[1]!==n||e[2]!==i||e[3]!==a||e[4]!==o||e[5]!==p||e[6]!==b?(f=function(){i==null||i({eventName:"message_unsend",extraData:c("getInstamadilloLoggingExtraData")(b),flowInstanceId:n}),p({message:a},function(){o(m)}),o(l),d("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectThread","direct_delete_message_attempt")},e[1]=n,e[2]=i,e[3]=a,e[4]=o,e[5]=p,e[6]=b,e[7]=f):f=e[7];var q;e[8]!==n||e[9]!==i||e[10]!==a||e[11]!==p||e[12]!==b?(q=[n,i,a,p,b],e[8]=n,e[9]=i,e[10]=a,e[11]=p,e[12]=b,e[13]=q):q=e[13];f=d("Int64Hooks").useCallbackInt64(f,q);q=d("MWPThreadCapabilitiesContext").useMWPThreadCapabilitiesContext();q=q.messageUnsendEnabled;if(!q||!g)return null;e[14]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._(/*BTDS*/"\u9001\u4fe1\u3092\u53d6\u308a\u6d88\u3057"),e[14]=q):q=e[14];g=q;e[15]===Symbol["for"]("react.memo_cache_sentinel")?(q=k.jsx(c("IGDSUndoCirclePanoOutline24Icon.react"),{alt:g,color:"ig-error-or-destructive",size:18}),e[15]=q):q=e[15];var r;e[16]===Symbol["for"]("react.memo_cache_sentinel")?(r={color:"errorOrDestructive"},e[16]=r):r=e[16];e[17]!==f?(q=k.jsx(c("IGDMessageContextMenuItem.react"),{delimiter:!0,icon:q,label:g,labelProps:r,onClick:f}),e[17]=f,e[18]=q):q=e[18];return q}function l(){return!0}function m(){return!1}g["default"]=a}),226);
__d("useIGDPinnedMessageLimitReachedDialog.react",["IGDSDialogPlaceholder.react","JSResourceForInteraction","react","react-compiler-runtime","useIGDSLazyDialog"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(){var a=d("react-compiler-runtime").c(3),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=c("JSResourceForInteraction")("IGDPinnedMessageLimitReachedDialog.react").__setRef("useIGDPinnedMessageLimitReachedDialog.react"),a[0]=b):b=a[0];b=c("useIGDSLazyDialog")(b,j);var e=b[0];a[1]!==e?(b=function(a,b){e({onContinue:a},b)},a[1]=e,a[2]=b):b=a[2];a=b;return a}function j(a){return i.jsx(c("IGDSDialogPlaceholder.react"),{fixedHeight:!0,fixedWidth:!0,onClose:a,size:"default"})}j.displayName=j.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("IGDMessageContextMenu.react",["IGDBroadcastChannelLoggingShapes","IGDSBox.react","IGDSPopover.react","IGDThreadListNewMessageLoggingDataContext","MWCMThreadTypes.react","MessengerWebUXLogger","WebUXLoggingSurfaceContextProvider","cr:21429","isMWEditedMessage","react","react-compiler-runtime","useIGDBroadcastChannelImpressionLoggerWithCheck","useIGDEditMessageMenuItem.react","useIGDMessageCopyMenuItem.react","useIGDMessageForwardMenuItem.react","useIGDMessageInspectMenuItem.react","useIGDMessageNegativeFeedbackMenuItem.react","useIGDMessagePositiveFeedbackMenuItem.react","useIGDMessageReactionMenuItem.react","useIGDMessageReplyMenuItem.react","useIGDMessageReportMenuItem.react","useIGDMessageTimestampMenuItem.react","useIGDMessageUnsendMenuItem.react","useIGDPinnedMessageLimitReachedDialog.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j={popover:{borderStartStartRadius:"x1rgw4pv",borderStartEndRadius:"x1vjm0to",borderEndEndRadius:"xnqoqkk",borderEndStartRadius:"x16lu3ki",marginBottom:"xu06os2",$$css:!0}};function a(a){var e=d("react-compiler-runtime").c(26),f=a.message,g=a.onClose;a=a.thread;var h=d("MWCMThreadTypes.react").isIGBroadcastChannelThread(a.threadSubtype),l=c("useIGDBroadcastChannelImpressionLoggerWithCheck")(f.threadKey,a.threadSubtype,d("IGDBroadcastChannelLoggingShapes").MESSAGE_OPTIONS_RENDERED_SHAPE),m=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),n;e[0]!==m?(n={eventName:"message_contextual_menu_rendered",flowInstanceId:m},e[0]=m,e[1]=n):n=e[1];m=c("MessengerWebUXLogger").useImpressionLoggerRef(n);n=c("useIGDMessageReplyMenuItem.react")(f,g);var o=c("useIGDMessageReactionMenuItem.react")(f,g),p=c("useIGDEditMessageMenuItem.react")(f,g,a),q=c("useIGDMessageCopyMenuItem.react")(f,g,a),r=c("useIGDMessageForwardMenuItem.react")(f,g),s=c("useIGDPinnedMessageLimitReachedDialog.react")();s=b("cr:21429")(f,g,a,s);g=c("useIGDMessagePositiveFeedbackMenuItem.react")(f,g);var t=c("useIGDMessageNegativeFeedbackMenuItem.react")(f),u;e[2]!==q||e[3]!==p||e[4]!==r||e[5]!==t||e[6]!==s||e[7]!==g||e[8]!==o||e[9]!==n?(u=[o,n,p,r,q,s,g,t],e[2]=q,e[3]=p,e[4]=r,e[5]=t,e[6]=s,e[7]=g,e[8]=o,e[9]=n,e[10]=u):u=e[10];q=u;e[11]!==q?(p=q.filter(Boolean),e[11]=q,e[12]=p):p=e[12];r=p;t=r;e[13]!==f?(s=c("isMWEditedMessage")(f),e[13]=f,e[14]=s):s=e[14];g=s;o=c("useIGDMessageTimestampMenuItem.react")(f.timestampMs,g,t.length>0);n=c("useIGDMessageUnsendMenuItem.react")(f,a);u=c("useIGDMessageReportMenuItem.react")(f,a.threadType);q=c("useIGDMessageInspectMenuItem.react")(f);e[15]!==t?(p=t.map(k),e[15]=t,e[16]=p):p=e[16];e[17]!==q||e[18]!==u||e[19]!==p||e[20]!==o||e[21]!==n?(r=i.jsx(d("WebUXLoggingSurfaceContextProvider").WebUXSurfaceLoggingContext.Provider,{value:"thread_view_message_options",children:i.jsxs(c("IGDSBox.react"),{minWidth:180,padding:2,children:[o,p,n,u,q]})}),e[17]=q,e[18]=u,e[19]=p,e[20]=o,e[21]=n,e[22]=r):r=e[22];s=r;g=h?l:m;e[23]!==s||e[24]!==g?(a=i.jsx(c("IGDSPopover.react"),{popoverContent:s,popoverXStyle:j.popover,ref:g}),e[23]=s,e[24]=g,e[25]=a):a=e[25];return a}function k(a,b){return i.jsx(c("IGDSBox.react"),{children:a},"igd-message-menu-item-"+b)}k.displayName=k.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("getSendProfileToInstamadilloRecipient",["fbt","FBLogger","I64","IGDDataclassTypes.flow","LSAuthorityLevel","LSMessageReplySourceTypeV2","LSMessageSendStatus","asyncToGeneratorRuntime","issueSendInstamadilloXMAReceiverFetch","renderInstamadilloOptimisticXmaReceiverFetch"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function a(a,e,f,g,j){if(f==null)throw c("FBLogger")("igd_web").mustfix("getSendProfileToInstamadilloRecipient: missing profileUsername");var k={__typename:"XMSGIgReceiverFetchXmaProfileFetchParams",igid:a};a={__typename:"XMSGIgXmaContentRefDataclass",action_type:d("IGDDataclassTypes.flow").XmsgIgXmaActionType.Share,content_type:d("IGDDataclassTypes.flow").XmsgIgReceiverFetchContentType.Profile,fetch_params:k,owner_fbid:e,target_url:g,username:f};var l={contentRef:JSON.stringify(a)},m={authorityLevel:(i||(i=d("I64"))).of_int32(c("LSAuthorityLevel").OPTIMISTIC),isForwarded:j,replySourceTypeV2:j===!0?(i||(i=d("I64"))).of_int32(c("LSMessageReplySourceTypeV2").FORWARD):void 0,sendStatus:i.of_int32(c("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:i.of_int32(1)},n={actionUrl:g,nativeUrl:g,type_:"xma_open_native"},o={authorityLevel:i.of_int32(c("LSAuthorityLevel").OPTIMISTIC),subtitleText:h._(/*BTDS*/"Profile").toString(),titleText:f};return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d,e,f,g){try{var h=(yield c("renderInstamadilloOptimisticXmaReceiverFetch")(a,l,k,o,n,m));yield c("issueSendInstamadilloXMAReceiverFetch")({comment:e,isDisappearingModeSettingOn:b,offlineThreadingId:h,openEb:d,receiverFetchXma:JSON.stringify(l),threadKey:a});f==null||f(a)}catch(b){g==null||g(b,a)}});return function(b,c,d,e,f,g){return a.apply(this,arguments)}}()}g["default"]=a}),226);
__d("getSendReelToInstamadilloRecipient",["fbt","I64","IGDDataclassTypes.flow","LSAuthorityLevel","LSIntEnum","LSMessageReplySourceTypeV2","LSMessageSendStatus","MNXMAPreviewImageDecorationType","asyncToGeneratorRuntime","issueSendInstamadilloXMAReceiverFetch","renderInstamadilloOptimisticXmaReceiverFetch"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function a(a,e,f,g,k){var l={__typename:"XMSGIgReceiverFetchXmaClipFetchParams",media_igid:a};e={__typename:"XMSGIgXmaContentRefDataclass",action_type:d("IGDDataclassTypes.flow").XmsgIgXmaActionType.Share,content_type:d("IGDDataclassTypes.flow").XmsgIgReceiverFetchContentType.Clip,fetch_params:l,owner_fbid:e,target_url:g,username:f};var m={contentRef:JSON.stringify(e)},n={authorityLevel:(i||(i=d("I64"))).of_int32(c("LSAuthorityLevel").OPTIMISTIC),isForwarded:k,replySourceTypeV2:k===!0?(i||(i=d("I64"))).of_int32(c("LSMessageReplySourceTypeV2").FORWARD):void 0,sendStatus:i.of_int32(c("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:i.of_int32(1)},o={actionUrl:g,nativeUrl:g,targetId:i.of_string(a),type_:"igd_web_post_share"},p={authorityLevel:i.of_int32(c("LSAuthorityLevel").OPTIMISTIC),previewImageDecorationType:(j||(j=d("LSIntEnum"))).ofNumber(c("MNXMAPreviewImageDecorationType").REEL),subtitleText:h._(/*BTDS*/"Reel").toString(),titleText:(f=e.username)!=null?f:""};return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d,e,f,g){try{var h=(yield c("renderInstamadilloOptimisticXmaReceiverFetch")(a,m,l,p,o,n));yield c("issueSendInstamadilloXMAReceiverFetch")({comment:e,isDisappearingModeSettingOn:b,offlineThreadingId:h,openEb:d,receiverFetchXma:JSON.stringify(m),threadKey:a});f==null||f(a)}catch(b){g==null||g(b,a)}});return function(b,c,d,e,f,g){return a.apply(this,arguments)}}()}g["default"]=a}),226);