;/*FB_PKG_DELIM*/

__d("sendIGDOptimisticRichContentMessage",["fbt","EntMessageReplyType","I64","LSAuthorityLevel","LSIntEnum","LSMessageRenderingType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSMessageSendStatus","LSQuickReplyType","LSReplyMessageStatus","MNLSXMALayoutType","MNLSXMATemplateType","PolarisDirectStrings","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function a(a,b,c,d,e,f,g,h,i,j,l,m){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g,k,l,m,n,o,p,q,r,s){var t={authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),displayedContentTypes:l,hasQuickReplies:!1,isAdminMessage:!1,isCollapsed:!1,isExpired:!1,isUnsent:!1,messageId:k,messageRenderingType:i.ofNumber(c("LSMessageRenderingType").DEFAULT),offlineThreadingId:k,primarySortKey:n,quickReplyType:i.ofNumber(c("LSQuickReplyType").NONE),senderId:m,sendStatus:i.ofNumber(c("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:i.ofNumber(1),textHasLinks:!1,threadKey:o,timestampMs:n,transportKey:"FBBroker",viewFlags:i.ofNumber(0)};if(s!=null){l=(yield a.runInTransaction(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.messages.index("messageId")).getKeyRange(s.messageId)));var c=b!=null?yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(b==null?void 0:b.senderId)):null;return{recipientName:c!=null&&(j||(j=d("I64"))).equal(c==null?void 0:c.id,m)?"yourself":c==null?void 0:c.name,replyMessageText:b==null?void 0:b.text}});return function(a){return c.apply(this,arguments)}}(),"readonly",void 0,void 0,f.id+":78"));var u=l.recipientName;l=l.replyMessageText;t=babelHelpers["extends"]({},t,{replyMessageText:l,replySnippet:u!=null?d("PolarisDirectStrings").youRepliedToUser(u).toString():h._(/*BTDS*/"You replied to Instagram User").toString(),replySourceId:s.messageId,replySourceType:(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceType").MESSAGE),replySourceTypeV2:i.ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE),replyStatus:i.ofNumber(c("LSReplyMessageStatus").VALID),replyToUserId:o,replyType:i.ofNumber(c("EntMessageReplyType").REGULAR)})}l={attachmentFbid:k,attachmentIndex:(j||(j=d("I64"))).zero,attachmentType:i.ofNumber(p),authorityLevel:i.ofNumber(c("LSAuthorityLevel").OPTIMISTIC),hasMedia:!1,hasXma:!1,imageUrl:q,isSharable:!1,messageId:k,playableUrl:q,previewHeight:e,previewUrl:q,previewUrlFallback:q,previewWidth:g,threadKey:o,timestampMs:n,transportKey:"FBBroker"};var v=babelHelpers["extends"]({},l);switch(r){case"cutout_sticker":v=babelHelpers["extends"]({},l,{hasXma:!0,stickerType:"cutout_sticker",xmaLayoutType:(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").SINGLE),xmasTemplateType:(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMATemplateType").GENERIC_SHARE)});break;case"first_party_sticker":v=babelHelpers["extends"]({},l,{hasMedia:!0});break;case"avatar_sticker":v=babelHelpers["extends"]({},l,{hasXma:!0,stickerType:"avatar_sticker",xmaLayoutType:(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMALayoutType").SINGLE),xmasTemplateType:(i||(i=d("LSIntEnum"))).ofNumber(c("MNLSXMATemplateType").GENERIC_SHARE)});break}return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.messages.put(t),yield a.attachments.put(v)});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":175")});return k.apply(this,arguments)}g["default"]=a}),226);